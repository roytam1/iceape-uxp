<?xml version="1.0"?>

<!-- This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this
   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->

<?xml-stylesheet href="chrome://messenger/skin/folderMenus.css" type="text/css"?>

<?xul-overlay href="chrome://communicator/content/charsetOverlay.xul"?>
<?xul-overlay href="chrome://communicator/content/contentAreaContextOverlay.xul"?>
<?xul-overlay href="chrome://communicator/content/viewZoomOverlay.xul"?>
<?xul-overlay href="chrome://communicator/content/viewApplyThemeOverlay.xul"?>
<?xul-overlay href="chrome://messenger/content/msgHdrViewOverlay.xul"?>
<?xul-overlay href="chrome://messenger/content/mailOverlay.xul"?>
<?xul-overlay href="chrome://messenger/content/mailKeysOverlay.xul"?>

<!DOCTYPE overlay [
  <!ENTITY % messengerDTD SYSTEM "chrome://messenger/locale/messenger.dtd">
  %messengerDTD;
  <!ENTITY % mailKeysDTD SYSTEM "chrome://messenger/locale/mailKeysOverlay.dtd">
  %mailKeysDTD;
  <!ENTITY % globalDTD SYSTEM "chrome://global/locale/global.dtd">
  %globalDTD;
  <!ENTITY % msgViewPickerDTD SYSTEM "chrome://messenger/locale/msgViewPickerOverlay.dtd">
  %msgViewPickerDTD;
  <!ENTITY % msgHdrViewPopupDTD SYSTEM "chrome://messenger/locale/msgHdrViewPopup.dtd">
  %msgHdrViewPopupDTD;
  <!ENTITY % contentAreaCommandsDTD SYSTEM "chrome://communicator/locale/contentAreaCommands.dtd">
  %contentAreaCommandsDTD;
  <!ENTITY % brandDTD SYSTEM "chrome://branding/locale/brand.dtd">
  %brandDTD;
]>

<overlay
  xmlns:nc="http://home.netscape.com/NC-rdf#"
  xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">

<script type="application/javascript" src="chrome://messenger/content/mailCommands.js"/>
<script type="application/javascript" src="chrome://messenger/content/junkCommands.js"/>
<script type="application/javascript" src="chrome://messenger/content/mailWindowOverlay.js"/>
<script type="application/javascript" src="chrome://messenger/content/msgViewPickerOverlay.js"/>
<script type="application/javascript" src="chrome://messenger-newsblog/content/newsblogOverlay.js"/>
<script type="application/javascript" src="chrome://messenger/content/mail-offline.js"/>
<script type="application/javascript" src="chrome://communicator/content/findUtils.js"/>
<script type="application/javascript" src="chrome://global/content/printUtils.js"/>
<script type="application/javascript" src="chrome://messenger/content/folderDisplay.js"/>
<script type="application/javascript"><![CDATA[
  Components.utils.import("resource://gre/modules/PlacesUtils.jsm");
  Components.utils.import("resource:///modules/PlacesUIUtils.jsm");
]]></script>

<stringbundleset id="stringbundleset">
  <stringbundle id="bundle_messenger" src="chrome://messenger/locale/messenger.properties"/>
  <stringbundle id="bundle_offlinePrompts" src="chrome://messenger/locale/offline.properties"/>
  <stringbundle id="bundle_viewZoom"/>
  <stringbundle id="bundle_viewApplyTheme"/>
  <stringbundle id="findBundle" src="chrome://global/locale/finddialog.properties"/>
</stringbundleset>

<broadcasterset id="mailBroadcasters">
  <!-- Go Menu -->
  <broadcaster id="mailFolderPane"/>
</broadcasterset>

<!-- Performance optimization...we include utilityOverlay.xul which defines some command sets
     which are updated based on events like focus and select. We have our own custom events
     which we use to optmize when we do command updating. To avoid unnecessary command updating,
     we are going to override the events the global edit menu items and select edit menu items
     are updated on with events of our own controlling.
 -->

<commandset id="globalEditMenuItems"
            commandupdater="true"
            events="create-menu-edit"
            oncommandupdate="goUpdateGlobalEditMenuItems()"/>
<commandset id="selectEditMenuItems"
            commandupdater="true"
            events="create-menu-edit"
            oncommandupdate="goUpdateSelectEditMenuItems()"/>

<!-- End command set merging -->

<commandset id="mailDownloadCommands">
  <command id="cmd_downloadFlagged" oncommand="goDoCommand('cmd_downloadFlagged')"/>
  <command id="cmd_downloadSelected" oncommand="goDoCommand('cmd_downloadSelected')"/>
</commandset>

<commandset id="mailFileMenuItems"
            commandupdater="true"
            events="create-menu-file, message-header-pane"
            oncommandupdate="goUpdateMailMenuItems(this)">

    <command id="cmd_getNewMessages" oncommand="goDoCommand('cmd_getNewMessages')" disabled="true"/>
    <command id="cmd_close" oncommand="goDoCommand('cmd_close')"/>
    <command id="cmd_open" oncommand="goDoCommand('cmd_open')"/>

    <command id="cmd_emptyTrash" oncommand="goDoCommand('cmd_emptyTrash')" disabled="true"/>
    <command id="cmd_compactFolder" oncommand="goDoCommand('cmd_compactFolder')" disabled="true"/>

    <command id="cmd_printSetup" oncommand="goDoCommand('cmd_printSetup')" disabled="true"/>
    <command id="cmd_print" oncommand="goDoCommand('cmd_print')" disabled="true"/>
    <command id="cmd_printpreview" oncommand="goDoCommand('cmd_printpreview')" disabled="true"/>
    <command id="cmd_saveAsFile" oncommand="goDoCommand('cmd_saveAsFile')" disabled="true"/>
    <command id="cmd_saveAsTemplate" oncommand="goDoCommand('cmd_saveAsTemplate')" disabled="true"/>
    <command id="cmd_getNextNMessages" oncommand="goDoCommand('cmd_getNextNMessages')" disabled="true"/>
    <command id="cmd_renameFolder" oncommand="goDoCommand('cmd_renameFolder')" />
    <command id="cmd_sendUnsentMsgs" oncommand="goDoCommand('cmd_sendUnsentMsgs')" />
    <command id="cmd_subscribe" oncommand="goDoCommand('cmd_subscribe')" disabled="true"/>
    <command id="cmd_synchronizeOffline" oncommand="goDoCommand('cmd_synchronizeOffline');" disabled="true"/>
    <command id="cmd_settingsOffline" oncommand="goDoCommand('cmd_settingsOffline');" disabled="true"/>
</commandset>

<commandset id="mailCommands">
  <command id="cmd_newNavigator"/>
  <command id="cmd_newPrivateWindow"/>
  <command id="cmd_newEditor"/>
  <command id="cmd_createFilterFromPopup" oncommand="goDoCommand('cmd_createFilterFromPopup')"/>
  <command id="cmd_pageSetup"/>
</commandset>

<commandset id="mailViewMenuItems"
            commandupdater="true"
            events="create-menu-view"
            oncommandupdate="goUpdateMailMenuItems(this)">

   <command id="cmd_viewPageSource" oncommand="goDoCommand('cmd_viewPageSource')" disabled="true"/>
   <command id="cmd_setFolderCharset" oncommand="goDoCommand('cmd_setFolderCharset')" />
   <command id="cmd_reload" oncommand="goDoCommand('cmd_reload')" disabled="true"/>

   <command id="cmd_expandAllThreads" oncommand="goDoCommand('cmd_expandAllThreads')" disabled="true"/>
   <command id="cmd_collapseAllThreads" oncommand="goDoCommand('cmd_collapseAllThreads')" disabled="true"/>
   <command id="cmd_viewAllMsgs" oncommand="goDoCommand('cmd_viewAllMsgs')" disabled="true"/>
   <command id="cmd_viewUnreadMsgs" oncommand="goDoCommand('cmd_viewUnreadMsgs')" disabled="true"/>
   <command id="cmd_viewThreadsWithUnread" oncommand="goDoCommand('cmd_viewThreadsWithUnread')" disabled="true"/>
   <command id="cmd_viewWatchedThreadsWithUnread" oncommand="goDoCommand('cmd_viewWatchedThreadsWithUnread')" disabled="true"/>
   <command id="cmd_viewIgnoredThreads" oncommand="goDoCommand('cmd_viewIgnoredThreads')" disabled="true"/>
   <!-- Needed to support the Lightning Task filter See Bug 316916 -->
   <command id="cmd_showQuickFilterBar" oncommand="goDoCommand('cmd_showQuickFilterBar');"/>
   <commandset id="viewZoomCommands"/>
</commandset>

<commandset id="mailEditMenuItems"
            commandupdater="true"
            events="create-menu-edit, message-header-pane"
            oncommandupdate="goUpdateMailMenuItems(this)">

  <command id="cmd_undo"
         valueDeleteMsg="&undoDeleteMsgCmd.label;"
         valueMoveMsg="&undoMoveMsgCmd.label;"
         valueCopyMsg="&undoCopyMsgCmd.label;"
         valueUnmarkAllMsgs="&undoMarkAllCmd.label;"
         valueDefault="&undoDefaultCmd.label;"/>
  <command id="cmd_redo"
         valueDeleteMsg="&redoDeleteMsgCmd.label;"
         valueMoveMsg="&redoMoveMsgCmd.label;"
         valueCopyMsg="&redoCopyMsgCmd.label;"
         valueUnmarkAllMsgs="&redoMarkAllCmd.label;"
         valueDefault="&redoDefaultCmd.label;"/>
  <command id="cmd_cut"/>
  <command id="cmd_copy"/>
  <command id="cmd_paste"/>
  <command id="cmd_delete"
         valueFolder="&deleteFolderCmd.label;"
         valueFolderAccessKey="&deleteFolderCmd.accesskey;"
         valueNewsgroup="&unsubscribeNewsgroupCmd.label;"
         valueNewsgroupAccessKey="&unsubscribeNewsgroupCmd.accesskey;"
         valueMessage="&deleteMsgCmd.label;"
         valueMessageAccessKey="&deleteMsgCmd.accesskey;"
         valueIMAPDeletedMessage="&undeleteMsgCmd.label;"
         valueIMAPDeletedMessageAccessKey="&undeleteMsgCmd.accesskey;"
         valueMessages="&deleteMsgsCmd.label;"
         valueMessagesAccessKey="&deleteMsgsCmd.accesskey;"
         valueIMAPDeletedMessages="&undeleteMsgsCmd.label;"
         valueIMAPDeletedMessagesAccessKey="&undeleteMsgsCmd.accesskey;"/>
  <command id="cmd_selectAll"/>
  <command id="cmd_selectThread" oncommand="goDoCommand('cmd_selectThread')"/>
  <command id="cmd_selectFlagged" oncommand="goDoCommand('cmd_selectFlagged')"/>
  <command id="cmd_properties" oncommand="goDoCommand('cmd_properties')"
         valueNewsgroup="&folderPropsNewsgroupCmd.label;"
         valueFolder="&folderPropsFolderCmd.label;"
         valueGeneric="&folderPropsCmd.label;"/>
  <command id="cmd_find" oncommand="goDoCommand('cmd_find')" disabled="true"/>
  <command id="cmd_findNext"
           oncommand="goDoCommand('cmd_findNext');"
           disabled="true"/>
  <command id="cmd_findPrev"  oncommand="goDoCommand('cmd_findPrev')"  disabled="true"/>
  <command id="cmd_findTypeText"/>
  <command id="cmd_findTypeLinks"/>
  <command id="cmd_stop" oncommand="MsgStop();"/>
</commandset>

<commandset id="mailEditContextMenuItems">
  <command id="cmd_copyLink"/>
  <command id="cmd_copyImage"/>
</commandset>

<commandset id="mailGoMenuItems"
            commandupdater="true"
            events="create-menu-go"
            oncommandupdate="goUpdateMailMenuItems(this)">

  <command id="cmd_nextMsg" oncommand="goDoCommand('cmd_nextMsg')" disabled="true"/>
  <command id="cmd_nextUnreadMsg" oncommand="goDoCommand('cmd_nextUnreadMsg')" disabled="true"/>
  <command id="cmd_nextFlaggedMsg" oncommand="goDoCommand('cmd_nextFlaggedMsg')" disabled="true"/>
  <command id="cmd_nextUnreadThread" oncommand="goDoCommand('cmd_nextUnreadThread')" disabled="true"/>
  <command id="cmd_previousMsg" oncommand="goDoCommand('cmd_previousMsg')" disabled="true"/>
  <command id="cmd_previousUnreadMsg" oncommand="goDoCommand('cmd_previousUnreadMsg')" disabled="true"/>
  <command id="cmd_previousFlaggedMsg" oncommand="goDoCommand('cmd_previousFlaggedMsg')" disabled="true"/>
  <command id="cmd_goStartPage" oncommand="goDoCommand('cmd_goStartPage');"/>
  <command id="cmd_goBack" oncommand="goDoCommand('cmd_goBack')" disabled="true"/>
  <command id="cmd_goForward" oncommand="goDoCommand('cmd_goForward');" disabled="true"/>
</commandset>

<commandset id="mailMessageMenuItems"
            commandupdater="true"
            events="create-menu-message"
            oncommandupdate="goUpdateMailMenuItems(this)">
  <command id="cmd_archive" oncommand="goDoCommand('cmd_archive')"/>
  <command id="cmd_reply" oncommand="goDoCommand('cmd_reply')"/>
  <command id="cmd_replyList" oncommand="goDoCommand('cmd_replyList')"/>
  <command id="cmd_replyGroup" oncommand="goDoCommand('cmd_replyGroup')"/>
  <command id="cmd_replySender" oncommand="goDoCommand('cmd_replySender')"/>
  <command id="cmd_replyall" oncommand="goDoCommand('cmd_replyall')"/>
  <command id="cmd_replySenderAndGroup" oncommand="goDoCommand('cmd_replySenderAndGroup')"/>
  <command id="cmd_replyAllRecipients" oncommand="goDoCommand('cmd_replyAllRecipients')"/>
  <command id="cmd_forward" oncommand="goDoCommand('cmd_forward')"/>
  <command id="cmd_forwardInline" oncommand="goDoCommand('cmd_forwardInline')"/>
  <command id="cmd_forwardAttachment" oncommand="goDoCommand('cmd_forwardAttachment')"/>
  <command id="cmd_editAsNew" oncommand="goDoCommand('cmd_editAsNew')"/>
  <command id="cmd_openMessage" oncommand="goDoCommand('cmd_openMessage')"/>
  <command id="cmd_createFilterFromMenu" oncommand="goDoCommand('cmd_createFilterFromMenu')"/>
  <command id="cmd_cancel" oncommand="goDoCommand('cmd_cancel')"/>
  <command id="cmd_killThread" oncommand="goDoCommand('cmd_killThread')"/>
  <command id="cmd_killSubthread" oncommand="goDoCommand('cmd_killSubthread')"/>
  <command id="cmd_watchThread" oncommand="goDoCommand('cmd_watchThread')"/>
</commandset>

<commandset id="mailToolbarItems"
            commandupdater="true"
            events="mail-toolbar"
            oncommandupdate="goUpdateMailMenuItems(this);
                             /* update cmd_delete manually to avoid a doubled id */
                             goUpdateCommand('cmd_delete');">
  <command id="button_reply"/>
  <command id="button_replyall"/>
  <command id="button_forward"/>
  <command id="button_delete"/>
  <command id="button_mark"/>
  <command id="button_getNewMessages"/>
  <command id="button_print"/>
  <command id="button_next"/>
  <command id="button_goBack"/>
  <command id="button_goForward"/>
  <command id="button_file"/>
  <command id="cmd_shiftDelete" oncommand="goDoCommand('cmd_shiftDelete');"/>
  <command id="button_junk"/>
  <command id="button_search"/>
</commandset>


<commandset id="mailGetMsgMenuItems"
            commandupdater="true"
            events="create-menu-getMsgToolbar,create-menu-file"
            oncommandupdate="goUpdateMailMenuItems(this)">

    <command id="cmd_getMsgsForAuthAccounts"
             oncommand="goDoCommand('cmd_getMsgsForAuthAccounts'); event.stopPropagation()"
             disabled="true"/>
</commandset>

<commandset id="mailMarkMenuItems"
              commandupdater="true"
              events="create-menu-mark"
              oncommandupdate="goUpdateMailMenuItems(this)">

    <command id="cmd_markAsRead" oncommand="goDoCommand('cmd_markAsRead'); event.stopPropagation()" disabled="true"/>
    <command id="cmd_markAllRead" oncommand="goDoCommand('cmd_markAllRead'); event.stopPropagation()" disabled="true"/>
    <command id="cmd_markThreadAsRead" oncommand="goDoCommand('cmd_markThreadAsRead'); event.stopPropagation()" disabled="true"/>
    <command id="cmd_markReadByDate" oncommand="goDoCommand('cmd_markReadByDate');" disabled="true"/>
    <command id="cmd_markAsFlagged" oncommand="goDoCommand('cmd_markAsFlagged'); event.stopPropagation()" disabled="true"/>
    <command id="cmd_markAsJunk" oncommand="goDoCommand('cmd_markAsJunk'); event.stopPropagation()" disabled="true"/>
    <command id="cmd_markAsNotJunk" oncommand="goDoCommand('cmd_markAsNotJunk'); event.stopPropagation()" disabled="true"/>
    <command id="cmd_recalculateJunkScore" oncommand="goDoCommand('cmd_recalculateJunkScore');" disabled="true"/>
    <command id="cmd_markAsShowRemote" oncommand="goDoCommand('cmd_markAsShowRemote'); event.stopPropagation()" disabled="true"/>
    <command id="cmd_markAsNotPhish" oncommand="goDoCommand('cmd_markAsNotPhish'); event.stopPropagation()" disabled="true"/>
</commandset>

<commandset id="mailToolsMenuItems"
              commandupdater="true"
              events="create-menu-tasks"
              oncommandupdate="goUpdateMailMenuItems(this)">
  <command id="cmd_displayMsgFilters"
           disabled="true"
           oncommand="goDoCommand('cmd_displayMsgFilters');"/>
  <command id="cmd_applyFilters" oncommand="goDoCommand('cmd_applyFilters');" disabled="true"/>
  <command id="cmd_applyFiltersToSelection"
           oncommand="goDoCommand('cmd_applyFiltersToSelection');"
           disabled="true"
           valueSelection="&filtersApplyToSelection.label;"
           valueSelectionAccessKey="&filtersApplyToSelection.accesskey;"
           valueMessage="&filtersApplyToMessage.label;"
           valueMessageAccessKey="&filtersApplyToMessage.accesskey;"/>
  <command id="cmd_runJunkControls" oncommand="goDoCommand('cmd_runJunkControls');" disabled="true"/>
  <command id="cmd_deleteJunk" oncommand="goDoCommand('cmd_deleteJunk');" disabled="true"/>
  <command id="cmd_search" oncommand="goDoCommand('cmd_search')"/>
</commandset>

<keyset id="mailKeys">
  <key id="space" key=" " modifiers="shift any" oncommand="SpaceHit(event);"/>

  <!-- File Menu -->
  <key id="key_newTab"
       key="&newTabCmd.key;"
       modifiers="accel"
       oncommand="MsgOpenNewTab();"/>
  <key id="key_newNavigator"/>
  <key id="key_newPrivateWindow"/>
  <key id="key_newBlankPage"/>
  <key id="key_close"/>
  <!-- Edit Menu -->
  <key id="key_undo"/>
  <key id="key_redo"/>
  <key id="key_cut"/>
  <key id="key_copy"/>
  <key id="key_paste"/>
  <key id="key_selectThread" key="&selectThreadCmd.key;"             oncommand="goDoCommand('cmd_selectThread');" modifiers="alt, shift"/>

  <key id="key_markJunk" key="&markAsJunkCmd.key;"                   oncommand="goDoCommand('cmd_markAsJunk');"/>
  <key id="key_markNotJunk" key="&markAsNotJunkCmd.key;"             oncommand="goDoCommand('cmd_markAsNotJunk');"
       modifiers="shift"/>
  <key id="key_markShowRemote" key="&markAsShowRemoteCmd.key;"       oncommand="goDoCommand('cmd_markAsShowRemote');"
       modifiers="shift"/>
  <key id="key_markNotPhish" key="&markAsNotPhishCmd.key;"           oncommand="goDoCommand('cmd_markAsNotPhish');"
       modifiers="shift"/>
  <key id="key_markAllRead" key="&markAllReadCmd.key;"               oncommand="goDoCommand('cmd_markAllRead');" modifiers="accel, shift"/>
  <key id="key_markThreadAsRead" key="&markThreadAsReadCmd.key;"     oncommand="goDoCommand('cmd_markThreadAsRead')"/>
  <key id="key_markReadByDate" key="&markReadByDateCmd.key;"         oncommand="goDoCommand('cmd_markReadByDate')"/>
  <key id="key_nextMsg" key="&nextMsgCmd.key;"                       oncommand="goDoCommand('cmd_nextMsg')"/>
  <key id="key_nextUnreadMsg" key="&nextUnreadMsgCmd.key;"           oncommand="goDoCommand('cmd_nextUnreadMsg')"/>
  <key id="key_expandAllThreads" key="&expandAllThreadsCmd.key;"     oncommand="goDoCommand('cmd_expandAllThreads')"/>
  <key key="&expandAllThreadsCmd.key;" modifiers="shift"             oncommand="goDoCommand('cmd_expandAllThreads')"/>
  <key id="key_collapseAllThreads" key="&collapseAllThreadsCmd.key;" oncommand="goDoCommand('cmd_collapseAllThreads')"/>
  <key key="&collapseAllThreadsCmd.key;" modifiers="shift"           oncommand="goDoCommand('cmd_collapseAllThreads')"/>
  <key id="key_nextUnreadThread" key="&nextUnreadThread.key;"        oncommand="goDoCommand('cmd_nextUnreadThread')"/>
  <key id="key_previousMsg" key="&prevMsgCmd.key;"                   oncommand="goDoCommand('cmd_previousMsg')"/>
  <key id="key_previousUnreadMsg" key="&prevUnreadMsgCmd.key;"       oncommand="goDoCommand('cmd_previousUnreadMsg')"/>
  <key id="key_archive" key="&archiveMsgCmd.key;"                    oncommand="goDoCommand('cmd_archive')" modifiers="shift"/>
  <key id="key_goBack" key="&goBackCmd.commandKey;"                  oncommand="goDoCommand('cmd_goBack')"/>
  <key id="key_goForward" key="&goForwardCmd.commandKey;"            oncommand="goDoCommand('cmd_goForward');"/>
  <key id="key_reply" key="&replyMsgCmd.key;"                        oncommand="goDoCommand('cmd_reply')" modifiers="accel"/>
  <key id="key_replyall" key="&replyToAllMsgCmd.key;"                oncommand="goDoCommand('cmd_replyall')" modifiers="accel, shift"/>
  <key id="key_forward" key="&forwardMsgCmd.key;"                    oncommand="goDoCommand('cmd_forward')" modifiers="accel"/>
  <key id="key_editAsNew" key="&editMsgAsNewCmd.key;"                oncommand="goDoCommand('cmd_editAsNew')" modifiers="accel"/>
  <key id="key_watchThread" key="&watchThreadMenu.key;"              oncommand="goDoCommand('cmd_watchThread')" />
  <key id="key_killThread" key="&killThreadMenu.key;"                oncommand="goDoCommand('cmd_killThread')" />
  <key id="key_killSubthread" key="&killSubthreadMenu.key;"          oncommand="goDoCommand('cmd_killSubthread')" modifiers="shift" />
  <key id="key_print"/>
  <key id="key_saveAsFile" key="&saveAsFileCmd.key;"                 oncommand="goDoCommand('cmd_saveAsFile')" modifiers="accel"/>
  <key id="key_viewPageSource" key="&pageSourceCmd.key;"             oncommand="goDoCommand('cmd_viewPageSource')" modifiers="accel"/>
  <key id="key_getNewMessages" key="&getNewMsgCmd2.key;"             oncommand="goDoCommand('cmd_getNewMessages')" modifiers="accel"/>
  <key id="key_getAllNewMessages"
       key="&getAllNewMsgCmd2.key;"
       oncommand="goDoCommand('cmd_getMsgsForAuthAccounts');"
       modifiers="accel, shift"/>
  <keyset id="findKeys"/>
  <key id="key_findTypeText"/>
  <key id="key_findTypeLinks"/>
  <key id="key_stop" keycode="VK_ESCAPE" command="cmd_stop"/>
  <keyset id="viewZoomKeys"/>
  <key id="key_reload"/>

  <!-- Tab/F6 Keys -->
  <key keycode="VK_TAB" oncommand="SwitchPaneFocus(event);" modifiers="control,shift"/>
  <key keycode="VK_TAB" oncommand="SwitchPaneFocus(event);" modifiers="control"/>
  <key keycode="VK_F6" oncommand="SwitchPaneFocus(event);" modifiers="control,shift"/>
  <key keycode="VK_F6" oncommand="SwitchPaneFocus(event);" modifiers="control"/>
  <key keycode="VK_F6" oncommand="SwitchPaneFocus(event);" modifiers="shift"/>
  <key keycode="VK_F6" oncommand="SwitchPaneFocus(event);"/>

  <!-- View Toggle Keys -->
  <key id="key_toggleFolderPane"
       oncommand="MsgToggleFolderPane(true);"
       observes="mailDisableKeys"/>
  <key id="key_toggleThreadPane"
       keycode="VK_F8"
       modifiers="shift"
       oncommand="MsgToggleThreadPane();"
       disabled="true"/>
  <key id="key_toggleMessagePane"
       keycode="VK_F8"
       oncommand="MsgToggleMessagePane(true);"
       disabled="true"/>

  <key id="key_searchMail" key="&searchMailCmd.key;" oncommand="goDoCommand('cmd_search')" modifiers="accel, shift"/>

  <key key="&focusSearchInput.key;"
       modifiers="accel"
       oncommand="focusElement(document.getElementById('searchInput'));"/>

  <!-- Needed to support the Lightning Task filter See Bug 316916 -->
  <key id="key_qfb_show"
       key="&quickFilterBar.show.key2;"
       modifiers="accel,shift"
       command="cmd_showQuickFilterBar"/>
</keyset>

  <menupopup id="folderPaneContext"
         onpopupshowing="return FillFolderPaneContextMenu();"
         onpopuphiding="if (event.target == this) FolderPaneOnPopupHiding();">
    <menuitem id="folderPaneContext-getMessages"
              label="&folderContextGetMessages.label;"
              accesskey="&folderContextGetMessages.accesskey;"
              oncommand="MsgGetMessage();"/>
    <menuitem id="folderPaneContext-openNewTab"
              label="&folderContextOpenNewTab.label;"
              accesskey="&folderContextOpenNewTab.accesskey;"
              oncommand="MsgOpenNewTabForFolder();"/>
    <menuitem id="folderPaneContext-openNewWindow"
              label="&folderContextOpenNewWindow.label;"
              accesskey="&folderContextOpenNewWindow.accesskey;"
              oncommand="MsgOpenNewWindowForFolder(null,-1);"/>
    <menuitem id="folderPaneContext-searchMessages"
              label="&folderContextSearchMessages.label;"
              accesskey="&folderContextSearchMessages.accesskey;"
              command="cmd_search"/>
    <menuitem id="folderPaneContext-subscribe"
        label="&folderContextSubscribe.label;"
        accesskey="&folderContextSubscribe.accesskey;"
        oncommand="MsgSubscribe();"/>
    <menuitem id="folderPaneContext-newsUnsubscribe"
        label="&folderContextUnsubscribe.label;"
        accesskey="&folderContextUnsubscribe.accesskey;"
        oncommand="MsgUnsubscribe();"/>

    <menuseparator id="folderPaneContext-sep1"/>

    <menuitem id="folderPaneContext-new"
        label="&folderContextNew.label;"
        accesskey="&folderContextNew.accesskey;"
        oncommand="MsgNewFolder(NewFolder);"/>
    <menuitem id="folderPaneContext-remove"
              label="&folderContextRemove.label;"
              accesskey="&folderContextRemove.accesskey;"
              oncommand="MsgDeleteFolder();"/>
    <menuitem id="folderPaneContext-rename"
        label="&folderContextRename.label;"
        accesskey="&folderContextRename.accesskey;"
        oncommand="MsgRenameFolder();"/>

    <menuitem id="folderPaneContext-compact"
        label="&folderContextCompact.label;"
        accesskey="&folderContextCompact.accesskey;"
        oncommand="MsgCompactFolder(false);"/>
    <menuitem id="folderPaneContext-markMailFolderAllRead"
              label="&folderContextMarkMailFolderRead.label;"
              accesskey="&folderContextMarkMailFolderRead.accesskey;"
              oncommand="MsgMarkAllRead();"/>
    <menuitem id="folderPaneContext-markNewsgroupAllRead"
              label="&folderContextMarkNewsgroupRead.label;"
              accesskey="&folderContextMarkNewsgroupRead.accesskey;"
              oncommand="MsgMarkAllRead();"/>
    <menuitem id="folderPaneContext-emptyTrash"
        label="&folderContextEmptyTrash.label;"
        accesskey="&folderContextEmptyTrash.accesskey;"
        oncommand="MsgEmptyTrash();"/>
    <menuitem id="folderPaneContext-emptyJunk"
        label="&folderContextEmptyJunk.label;"
        accesskey="&folderContextEmptyJunk.accesskey;"
        oncommand="deleteAllInFolder('emptyJunk');"/>
    <menuitem id="folderPaneContext-sendUnsentMessages"
        label="&folderContextSendUnsentMessages.label;"
        accesskey="&folderContextSendUnsentMessages.accesskey;"
        oncommand="goDoCommand('cmd_sendUnsentMsgs')"/>

    <menuseparator id="folderPaneContext-sep-edit"/>

    <menuitem id="folderPaneContext-properties"
        label="&folderContextProperties.label;"
        accesskey="&folderContextProperties.accesskey;"
        oncommand="MsgFolderProperties();"/>
    <menuitem id="folderPaneContext-settings"
              label="&folderContextSettings.label;"
              accesskey="&folderContextSettings.accesskey;"
              oncommand="MsgFolderProperties();"/>
  </menupopup>

  <menupopup id="mailContext"
         onpopupshowing="return event.target != this ||
                                FillMailContextMenu(this, event);"
         onpopuphiding="if (event.target == this) MailContextOnPopupHiding(this);">
    <menuitem id="context-openlinkintab"
              label="&openLinkCmdInTab.label;"
              accesskey="&openLinkCmdInTab.accesskey;"
              oncommand="gContextMenu.openLinkInTab(event);"/>
    <menuitem id="context-openlink"
              label="&openLinkCmd.label;"
              accesskey="&openLinkCmd.accesskey;"
              oncommand="gContextMenu.openLinkInWindow();"/>
    <menuseparator id="mailContext-sep-link"/>
    <menuitem id="context-selectall"/>
    <menuitem id="context-copy"/>
    <menuitem id="context-searchselect"
              oncommand="MsgOpenSearch(gContextMenu.searchSelected(), event);"/>
    <menuitem id="mailContext-openNewTab"
              label="&contextOpenNewTab.label;"
              accesskey="&contextOpenNewTab.accesskey;"
              oncommand="MsgOpenNewTabForMessage();"/>
    <menuitem id="mailContext-openNewWindow"
              label="&contextOpenNewWindow.label;"
              accesskey="&contextOpenNewWindow.accesskey;"
              oncommand="MsgOpenNewWindowForMessage();"/>
    <menuseparator id="mailContext-sep-open"/>
    <menuitem id="mailContext-replySender"
              label="&contextReplySender.label;"
              accesskey="&contextReplySender.accesskey;"
              oncommand="MsgReplySender(event);"/>
    <menuitem id="mailContext-replyList"
              label="&contextReplyList.label;"
              accesskey="&contextReplyList.accesskey;"
              oncommand="MsgReplyList(event);"/>
    <menuitem id="mailContext-replyNewsgroup"
              label="&contextReplyNewsgroup.label;"
              accesskey="&contextReplyNewsgroup.accesskey;"
              oncommand="MsgReplyGroup(event);"/>
    <menuitem id="mailContext-replySenderAndNewsgroup"
              label="&contextReplySenderAndNewsgroup.label;"
              accesskey="&contextReplySenderAndNewsgroup.accesskey;"
              oncommand="MsgReplyToSenderAndGroup(event);"/>
    <menuitem id="mailContext-replyAll"
              label="&contextReplyAll.label;"
              accesskey="&contextReplyAll.accesskey;"
              oncommand="MsgReplyToAllRecipients(event);"/>
    <menuitem id="mailContext-forward"
              label="&contextForward.label;"
              accesskey="&contextForward.accesskey;"
              oncommand="MsgForwardMessage(event);"/>
    <menuitem id="mailContext-forwardAsAttachment"
              label="&contextForwardAsAttachment.label;"
              accesskey="&contextForwardAsAttachment.accesskey;"
              oncommand="MsgForwardAsAttachment(event);"/>
    <menuitem id="mailContext-editAsNew"
              label="&contextEditAsNew.label;"
              accesskey="&contextEditAsNew.accesskey;"
              oncommand="MsgEditMessageAsNew();"/>
    <menuseparator id="mailContext-sep-tags"/>
    <menu id="mailContext-tags"
          label="&tagMenu.label;"
          accesskey="&tagMenu.accesskey;">
      <menupopup id="mailContext-tagpopup"
                 onpopupshowing="InitMessageTags(this)">
        <menuitem id="mailContext-tagRemoveAll"
                  oncommand="RemoveAllMessageTags();"/>
        <menuseparator id="mailContext-sep-afterTagRemoveAll"/>
        <menuseparator id="mailContext-sep-beforeAddNewTag"/>
        <menuitem id="mailContext-tagCustomize"
                  label="&tagCustomize.label;"
                  accesskey="&tagCustomize.accesskey;"
                  oncommand="goPreferences('tags_pane');"/>
      </menupopup>
    </menu>
    <menu id="mailContext-mark"
          label="&markMenu.label;"
          accesskey="&markMenu.accesskey;">
      <menupopup id="mailContext-markPopup"
                 onpopupshowing="InitMessageMark()">
        <menuitem id="mailContext-markRead"
                  type="checkbox"
                  label="&markAsReadCmd.label;"
                  accesskey="&markAsReadCmd.accesskey;"
                  command="cmd_markAsRead"/>
        <menuitem id="mailContext-markThreadAsRead"
                  label="&markThreadAsReadCmd.label;"
                  accesskey="&markThreadAsReadCmd.accesskey;"
                  command="cmd_markThreadAsRead"/>
        <menuitem id="mailContext-markReadByDate"
                  label="&markReadByDateCmd.label;"
                  accesskey="&markReadByDateCmd.accesskey;"
                  command="cmd_markReadByDate"/>
        <menuitem id="mailContext-markAllRead"
                  label="&markAllReadCmd.label;"
                  accesskey="&markAllReadCmd.accesskey;"
                  command="cmd_markAllRead"/>
        <menuseparator id="mailContext-sep-afterMarkAllRead"/>
        <menuitem id="mailContext-markFlagged"
                  type="checkbox"
                  label="&markFlaggedCmd.label;"
                  accesskey="&markFlaggedCmd.accesskey;"
                  command="cmd_markAsFlagged"/>
        <menuseparator id="mailContext-sep-afterMarkFlagged"/>
        <menuitem id="mailContext-markAsJunk"
                  label="&markAsJunkCmd.label;"
                  accesskey="&markAsJunkCmd.accesskey;"
                  command="cmd_markAsJunk"/>
        <menuitem id="mailContext-markAsNotJunk"
                  label="&markAsNotJunkCmd.label;"
                  accesskey="&markAsNotJunkCmd.accesskey;"
                  command="cmd_markAsNotJunk"/>
        <menuitem id="mailContext-recalculateJunkScore"
                  label="&recalculateJunkScoreCmd.label;"
                  accesskey="&recalculateJunkScoreCmd.accesskey;"
                  command="cmd_recalculateJunkScore"/>
        <menuitem id="mailContext-markAsShowRemote"
                  label="&markAsShowRemoteCmd.label;"
                  accesskey="&markAsShowRemoteCmd.accesskey;"
                  command="cmd_markAsShowRemote"/>
        <menuitem id="mailContext-markAsNotPhish"
                  label="&markAsNotPhishCmd.label;"
                  accesskey="&markAsNotPhishCmd.accesskey;"
                  command="cmd_markAsNotPhish"/>
      </menupopup>
    </menu>
    <menuseparator id="mailContext-sep-mark"/>
    <menuitem id="mailContext-downloadflagged"
              label="&downloadFlaggedCmd.label;"
              accesskey="&downloadFlaggedCmd.accesskey;"
              command="cmd_downloadFlagged"/>
    <menuitem id="mailContext-downloadselected"
              label="&downloadSelectedCmd.label;"
              accesskey="&downloadSelectedCmd.accesskey;"
              command="cmd_downloadSelected"/>
    <menuseparator id="mailContext-sep-move"/>
    <menuitem id="mailContext-copyMessageUrl"
              label="&copyMessageLocation.label;"
              accesskey="&copyMessageLocation.accesskey;"
              oncommand="CopyMessageUrl()"/>
    <menuitem id="mailContext-archive"
              label="&contextArchive.label;"
              accesskey="&contextArchive.accesskey;"
              oncommand="MsgArchiveSelectedMessages(event);"/>
    <menu id="mailContext-moveMenu"
          label="&contextMoveMsgMenu.label;"
          accesskey="&contextMoveMsgMenu.accesskey;"
          sortResource="http://home.netscape.com/NC-rdf#FolderTreeName"
          sortDirection="ascending"
          datasources="rdf:null">
      <menupopup id="mailContext-fileHereMenu">
        <menu label="&contextMoveCopyMsgRecentMenu.label;"
              accesskey="&contextMoveCopyMsgRecentMenu.accesskey;"
              sortResource="http://home.netscape.com/NC-rdf#FolderTreeName"
              sortDirection="ascending"
              datasources="rdf:mailnewsrecentfolders"
              ref="mailnewsrecentfolders:/">
          <menupopup/>
          <template>
            <rule nc:CanFileMessages="true">
              <menupopup>
                <menuitem uri="..." class="folderMenuItem menuitem-iconic"
                          label="rdf:http://home.netscape.com/NC-rdf#FolderTreeSimpleName"
                          oncommand="MsgMoveMessage(event.target);"
                          SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
                          BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
                          IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
                          IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
                          ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType"/>
              </menupopup>
            </rule>
          </template>
        </menu>
        <menuseparator/>
      </menupopup>
      <template>
      <rule nc:NoSelect="true" iscontainer="true" isempty="false">
          <menupopup>
            <menu uri="..."  class="folderMenuItem menu-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name">
              <menupopup>
                <menuitem label="&fileHereMenu.label;" accesskey="&fileHereMenu.accesskey;" disabled="true"/>
                <menuseparator/>
              </menupopup>
            </menu>
          </menupopup>
        </rule>
        <rule nc:NoSelect="true">
          <menupopup>
            <menuitem uri="..."  class="folderMenuItem menu-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name" disabled="true"/>
          </menupopup>
        </rule>
        <rule nc:CanFileMessages="true" iscontainer="true" isempty="false">
          <menupopup>
            <menu uri="..."  class="folderMenuItem menu-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name"
              SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
              BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
              IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
              IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
              ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType">
              <menupopup>
                <menuitem label="&fileHereMenu.label;" accesskey="&fileHereMenu.accesskey;"
                  oncommand="MsgMoveMessage(event.target.parentNode.parentNode)"/>
                <menuseparator/>
              </menupopup>
            </menu>
          </menupopup>
        </rule>
        <rule nc:CanFileMessagesOnServer="false">
          <!-- don't show servers (nntp & any others) which does not allow message filing -->
          <!-- File, Move & Copy menus -->
        </rule>
        <rule nc:CanFileMessages="false" iscontainer="true" isempty="false">
          <!-- note, there is no "file here" -->
          <menupopup>
            <menu uri="..."  class="folderMenuItem menu-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name"
                  SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
                  BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
                  IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
                  IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
                  ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType">
              <menupopup/>
            </menu>
          </menupopup>
        </rule>
        <rule nc:CanFileMessages="true">
          <menupopup>
            <menuitem uri="..." class="folderMenuItem menuitem-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name" oncommand="MsgMoveMessage(event.target)"
              SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
              BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
              IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
              IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
              ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType"/>
          </menupopup>
        </rule>
      </template>
    </menu>
    <menu id="mailContext-copyMenu"
          label="&contextCopyMsgMenu.label;"
          accesskey="&contextCopyMsgMenu.accesskey;"
          sortResource="http://home.netscape.com/NC-rdf#FolderTreeName"
          sortDirection="ascending"
          datasources="rdf:null">
      <menupopup id="mailContext-copyHereMenu">
        <menu label="&contextMoveCopyMsgRecentMenu.label;"
              accesskey="&contextMoveCopyMsgRecentMenu.accesskey;"
              sortResource="http://home.netscape.com/NC-rdf#FolderTreeName"
              sortDirection="ascending"
              datasources="rdf:mailnewsrecentfolders"
              ref="mailnewsrecentfolders:/">
          <menupopup/>
          <template>
            <rule nc:CanFileMessages="true">
              <menupopup>
                <menuitem uri="..." class="folderMenuItem menuitem-iconic"
                          label="rdf:http://home.netscape.com/NC-rdf#FolderTreeSimpleName"
                          oncommand="MsgCopyMessage(event.target);"
                          SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
                          BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
                          IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
                          IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
                          ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType"/>
              </menupopup>
            </rule>
          </template>
        </menu>
        <menuseparator/>
      </menupopup>
      <template>
      <rule nc:NoSelect="true" iscontainer="true" isempty="false">
          <menupopup>
            <menu uri="..."  class="folderMenuItem menu-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name">
              <menupopup>
                <menuitem label="&copyHereMenu.label;" accesskey="&copyHereMenu.accesskey;" disabled="true"/>
                <menuseparator/>
              </menupopup>
            </menu>
          </menupopup>
        </rule>
        <rule nc:NoSelect="true">
          <menupopup>
            <menuitem uri="..."  class="folderMenuItem menu-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name" disabled="true"/>
          </menupopup>
        </rule>
        <rule nc:CanFileMessages="true" iscontainer="true" isempty="false">
          <menupopup>
            <menu uri="..."  class="folderMenuItem menu-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name"
              SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
              BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
              IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
              IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
              ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType">
              <menupopup>
                <menuitem label="&copyHereMenu.label;" accesskey="&copyHereMenu.accesskey;"
                  oncommand="MsgCopyMessage(event.target.parentNode.parentNode)"/>
                <menuseparator/>
              </menupopup>
            </menu>
          </menupopup>
        </rule>
        <rule nc:CanFileMessagesOnServer="false">
          <!-- don't show servers (nntp & any others) which does not allow message filing -->
          <!-- File, Move & Copy menus -->
        </rule>
        <rule nc:CanFileMessages="false" iscontainer="true" isempty="false">
          <!-- note, there is no "file here" -->
          <menupopup>
            <menu uri="..."  class="folderMenuItem menu-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name"
                  SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
                  BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
                  IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
                  IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
                  ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType">
              <menupopup/>
            </menu>
          </menupopup>
        </rule>
        <rule nc:CanFileMessages="true">
          <menupopup>
            <menuitem uri="..." class="folderMenuItem menuitem-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name"
              oncommand="MsgCopyMessage(event.target)"
              SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
              BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
              IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
              IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
              ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType"/>
          </menupopup>
        </rule>
      </template>
    </menu>
    <menuitem id="mailContext-saveAs"
              label="&contextSaveAs.label;"
              accesskey="&contextSaveAs.accesskey;"
              oncommand="MsgSaveAsFile();"/>
    <menuitem id="mailContext-delete"
              command="cmd_delete"/>
    <menuseparator id="mailContext-sep-print"/>
    <menuitem id="mailContext-printpreview"
              label="&contextPrintPreview.label;"
              accesskey="&contextPrintPreview.accesskey;"
              oncommand="PrintEnginePrintPreview();"/>
    <menuitem id="mailContext-print"
              label="&contextPrint.label;"
              accesskey="&contextPrint.accesskey;"
              oncommand="PrintEnginePrint();"/>
    <menuseparator id="mailContext-sep-edit"/>
    <menuitem id="context-copylink"
              label="&copyLinkCmd.label;"
              accesskey="&copyLinkCmd.accesskey;"
              command="cmd_copyLink"/>
    <menuitem id="context-copyimage"
              label="&copyImageCmd.label;"
              accesskey="&copyImageCmd.accesskey;"
              command="cmd_copyImage"/>
    <menuitem id="context-viewimage"
              label="&viewImageCmd.label;"
              accesskey="&viewImageCmd.accesskey;"
              oncommand="gContextMenu.viewMedia();"/>
    <menuitem id="context-blockimage"
              oncommand="gContextMenu.toggleImageBlocking(true);"/>
    <menuitem id="context-unblockimage"
              oncommand="gContextMenu.toggleImageBlocking(false);"/>
    <menuitem id="context-addemail"
              label="&AddToAddressBook.label;"
              accesskey="&AddToAddressBook.accesskey;"
              oncommand="AddEmailToAddressBook(gContextMenu.getEmail(), gContextMenu.linkText());"/>
    <menuseparator id="mailContext-sep-image"/>
    <menuitem id="context-composeemailto"
              label="&SendMailTo.label;"
              accesskey="&SendMailTo.accesskey;"
              oncommand="SendMailTo(gContextMenu.getEmail(), event);"/>
    <menuitem id="context-createfilterfrom"
              label="&CreateFilterFrom.label;"
              accesskey="&CreateFilterFrom.accesskey;"
              oncommand="CreateFilterFromMail(gContextMenu.getEmail());"/>
    <menuitem id="context-copyemail"
              label="&copyEmailCmd.label;"
              accesskey="&copyEmailCmd.accesskey;"
              oncommand="gContextMenu.copyEmail();"/>
    <menuseparator id="mailContext-sep-copy"/>
    <menuitem id="context-savelink"
              label="&saveLinkCmd.label;"
              accesskey="&saveLinkCmd.accesskey;"
              oncommand="gContextMenu.saveLink();"/>
    <menuitem id="context-saveimage"
              label="&saveImageCmd.label;"
              accesskey="&saveImageCmd.accesskey;"
              oncommand="gContextMenu.saveImage();"/>
    <menuitem id="context-bookmarklink"
              label="&bookmarkLinkCmd.label;"
              accesskey="&bookmarkLinkCmd.accesskey;"
              oncommand="PlacesUIUtils.showMinimalAddBookmarkUI(makeURI(gContextMenu.linkURL),
                                                                gContextMenu.linkText());"/>
  </menupopup>

  <menupopup id="remoteContentOptions"
             onpopupshowing="onRemoteContentOptionsShowing(event);"
             oncommand="allowRemoteContentForURI(event.target);">
    <menuitem id="remoteContentOptionAllowForMsg"
              label="&remoteContentOptionsAllowForMsg.label;"
              accesskey="&remoteContentOptionsAllowForMsg.accesskey;"
              oncommand="LoadMsgWithRemoteContent();"/>
    <menuseparator id="remoteContentSettingsMenuSeparator"/>
    <menuitem id="editRemoteContentSettings"
              label="&editRemoteContentSettings.label;"
              accesskey="&editRemoteContentSettings.accesskey;"
              oncommand="editRemoteContentSettings();"/>
  </menupopup>

  <toolbar type="menubar"
           id="mail-toolbar-menubar2"
           class="chromeclass-menubar"
           persist="collapsed"
           grippytooltiptext="&menuBar.tooltip;"
           customizable="true"
           defaultset="menubar-items"
           mode="icons"
           iconsize="small"
           defaultmode="icons"
           defaulticonsize="small"
           context="toolbar-context-menu">
    <toolbaritem id="menubar-items"
                 class="menubar-items"
                 align="center">
    </toolbaritem>
  </toolbar>

<menubar id="mail-menubar">
  <menu id="menu_File" >
    <menupopup id="menu_FilePopup" onpopupshowing="file_init();">
      <menu id="menu_New">
        <menupopup id="menu_NewPopup" onpopupshowing="menu_new_init();">
          <menuitem id="newNewMsgCmd"
                    label="&newNewMsgCmd.label;"
                    accesskey="&newNewMsgCmd.accesskey;"
                    key="key_newMessage"
                    oncommand="MsgNewMessage(null);"/>
          <menuitem id="menu_newFolder"
                    label="&newFolderCmd.label;"
                    accesskey="&newFolderCmd.accesskey;"
                    oncommand="MsgNewFolder(NewFolder);"/>
          <menuitem id="menu_newVirtualFolder" label="&newVirtualFolderCmd.label;"
                    oncommand="MsgVirtualFolderProperties(false);"
                    accesskey="&newVirtualFolderCmd.accesskey;"/>
          <menuitem id="newAccountMenuItem"
                    label="&newAccountCmd.label;"
                    accesskey="&newAccountCmd.accesskey;"
                    oncommand="MsgAccountWizard();"/>
          <menuseparator id="newPopupMenuSeparator"/>
          <menuitem id="menu_newCard"/>
          <menuitem id="menu_newTab"
                    label="&newTabCmd.label;"
                    accesskey="&newTabCmd.accesskey;"
                    key="key_newTab"
                    oncommand="MsgOpenNewTab();"/>
          <menuitem id="menu_newNavigator"/>
          <menuitem id="menu_newPrivateWindow"/>
          <menuitem id="menu_newEditor"/>
        </menupopup>
      </menu>
      <menuitem id="openMessageFileMenuitem" label="&openMessageFileCmd.label;"
        key="key_openFileMessage"
        accesskey="&openMessageFileCmd.accesskey;"
        oncommand="MsgOpenFromFile();"/>
      <menuitem id="menu_close"/>
      <menuseparator id="fileMenuAfterCloseSeparator"/>
      <menu id="menu_saveAs" label="&saveAsMenu.label;" accesskey="&saveAsMenu.accesskey;">
        <menupopup id="menu_SavePopup">
          <menuitem id="menu_saveAsFile"
                    label="&saveAsFileCmd.label;"
                    accesskey="&saveAsFileCmd.accesskey;"
                    key="key_saveAsFile"
                    command="cmd_saveAsFile"/>
          <menuitem id="menu_saveAsTemplate"
                    label="&saveAsTemplateCmd.label;"
                    accesskey="&saveAsTemplateCmd.accesskey;"
                    command="cmd_saveAsTemplate"/>
        </menupopup>
      </menu>
      <menuseparator id="fileMenuAfterSaveSeparator"/>
      <menuitem id="menu_getNewMsg"
                label="&getNewMsgCmd.label;"
                accesskey="&getNewMsgCmd.accesskey;"
                key="key_getNewMessages"
                command="cmd_getNewMessages"/>
        <menu id="menu_getAllNewMsg"
              label="&getNewMsgForCmd.label;"
              accesskey="&getNewMsgForCmd.accesskey;"
              sortResource="http://home.netscape.com/NC-rdf#FolderTreeName"
              sortDirection="ascending"
              datasources="rdf:msgaccountmanager rdf:mailnewsfolders"
              containment="http://home.netscape.com/NC-rdf#child"
              ref="msgaccounts:/"
              command="cmd_getNewMessages">
          <menupopup id="menu_getAllNewMsgPopup">
            <menuitem id="menu_getAllNewMsgPopupMenu"
                      label="&getAllNewMsgCmdPopupMenu.label;"
                      accesskey="&getAllNewMsgCmdPopupMenu.accesskey;"
                      key="key_getAllNewMessages"
                      command="cmd_getMsgsForAuthAccounts"/>
            <menuseparator id="fileMenuAfterGetNewMsgSeparator"/>
          </menupopup>
          <template>
            <rule nc:IsServer="true" nc:CanGetMessages="true">
              <menupopup>
                <menuitem uri="..."
                          value="..."
                          label="rdf:http://home.netscape.com/NC-rdf#Name"
                          oncommand="MsgGetMessagesForAccount(event)"/>
              </menupopup>
            </rule>
          </template>
        </menu>
      <menuitem id="menu_getnextnmsg" label="&getNextNMsgCmd.label;"
       accesskey="&getNextNMsgCmd.accesskey;"
       command="cmd_getNextNMessages"/>
      <menuitem id="menu_sendunsentmsgs" label="&sendUnsentCmd.label;"
       accesskey="&sendUnsentCmd.accesskey;"
       command="cmd_sendUnsentMsgs"/>
      <menuitem label="&subscribeCmd.label;"
                accesskey="&subscribeCmd.accesskey;"
                command="cmd_subscribe"/>
      <menuseparator id="fileMenuAfterSubscribeSeparator"/>
      <menuitem id="menu_renameFolder" label="&renameFolder.label;"
                accesskey="&renameFolder.accesskey;"
                command="cmd_renameFolder"
                observes="mailHideMenus"/>
      <menuitem id="menu_compactFolder" label="&compactFolders.label;"
                accesskey="&compactFolders.accesskey;"
                command="cmd_compactFolder"
                observes="mailHideMenus"/>
      <menuitem id="menu_emptyTrash" label="&emptyTrashCmd.label;"
                accesskey="&emptyTrashCmd.accesskey;"
                command="cmd_emptyTrash"
                observes="mailHideMenus"/>
      <menuseparator id="trashMenuSeparator" observes="mailHideMenus"/>
      <menu id="menu_Offline"
            label="&offlineMenu.label;"
            accesskey="&offlineMenu.accesskey;">
        <menupopup id="menu_OfflinePopup">
           <menuitem id="offlineGoOfflineCmd"/>
           <menuseparator id="offlineMenuAfterGoSeparator"/>
           <menuitem id="menu_synchronizeOffline"
                     label="&synchronizeOfflineCmd.label;"
                     accesskey="&synchronizeOfflineCmd.accesskey;"
                     command="cmd_synchronizeOffline"/>
           <menuitem id="menu_settingsOffline"
                     label="&settingsOfflineCmd.label;"
                     accesskey="&settingsOfflineCmd.accesskey;"
                     command="cmd_settingsOffline"/>
           <menuseparator id="offlineMenuAfterSettingsSeparator"/>
           <menuitem id="menu_downloadFlagged"
                      label="&downloadFlaggedCmd.label;"
                      accesskey="&downloadFlaggedCmd.accesskey;"
                      command="cmd_downloadFlagged"/>
           <menuitem id="menu_downloadSelected"
                     label="&downloadSelectedCmd.label;"
                     accesskey="&downloadSelectedCmd.accesskey;"
                     command="cmd_downloadSelected"/>
        </menupopup>
      </menu>
      <menuseparator id="fileMenuAfterOfflineSeparator"/>
      <menuitem id="menu_printSetup"/>
      <menuitem id="menu_printPreview"/>
      <menuitem id="menu_print"/>
    </menupopup>
  </menu>

  <menu id="menu_Edit" oncommand="CommandUpdate_UndoRedo();">
    <menupopup id="menu_EditPopup" onpopupshowing="InitEditMessagesMenu()">
      <menuitem id="menu_undo"/>
      <menuitem id="menu_redo"/>
      <menuseparator id="editMenuAfterRedoSeparator"/>
      <menuitem id="menu_cut"/>
      <menuitem id="menu_copy"/>
      <menuitem id="menu_paste"/>
      <menuitem id="menu_delete" command="cmd_delete"/>
      <menuseparator id="editMenuAfterDeleteSeparator"/>
      <menu id="menu_select" label="&selectMenu.label;"
            accesskey="&selectMenu.accesskey;">
        <menupopup id="menu_SelectPopup">
          <menuitem id="menu_mailSelectAll"
                    label="&all.label;"
                    accesskey="&all.accesskey;" key="key_selectAll"
                    command="cmd_selectAll"/>
          <menuseparator id="selectMenuSeparator"/>
          <menuitem id="menu_selectThread"
                    label="&selectThreadCmd.label;"
                    accesskey="&selectThreadCmd.accesskey;" key="key_selectThread"
                    command="cmd_selectThread"/>
          <menuitem id="menu_selectFlagged"
                    label="&selectFlaggedCmd.label;"
                    accesskey="&selectFlaggedCmd.accesskey;"
                    command="cmd_selectFlagged"/>
        </menupopup>
      </menu>
      <menuseparator id="editMenuAfterSelectSeparator"/>
      <menuitem id="menu_find" label="&findCmd.label;"/>
      <menuitem id="menu_findNext"/>
      <menuitem id="menu_findPrev"/>
      <menuseparator id="editMenuAfterFindSeparator"/>
      <menuitem id="menu_findTypeLinks"/>
      <menuitem id="menu_findTypeText"/>
      <menuseparator id="editPropertiesSeparator"/>
      <menuitem id="menu_properties" label="&folderPropsCmd.label;"
                accesskey="&folderPropsCmd.accesskey;"
                command="cmd_properties"
                observes="mailHideMenus"/>
      <menuitem id="menu_accountmgr"
                label="&accountManagerCmd.label;"
                accesskey="&accountManagerCmd.accesskey;"
                oncommand="MsgAccountManager(null);"/>
      <menuitem id="menu_preferences" oncommand="goPreferences('mailnews_pane')"/>
    </menupopup>
  </menu>

  <menu id="menu_View">
    <menupopup id="menu_View_Popup" onpopupshowing="view_init()">
      <menu id="menu_Toolbars">
        <menupopup id="view_toolbars_popup"
                   onpopupshowing="onViewToolbarsPopupShowing(event)"
                   oncommand="onViewToolbarCommand(event);">
          <menuitem id="menu_showTaskbar"/>
        </menupopup>
      </menu>
      <menu id="menu_MessagePaneLayout" label="&messagePaneLayoutStyle.label;"
            accesskey="&messagePaneLayoutStyle.accesskey;" observes="mailHideMenus">
        <menupopup id="view_layout_popup" onpopupshowing="InitViewLayoutStyleMenu(event)">
          <menuitem id="messagePaneClassic" type="radio" label="&messagePaneClassic.label;" name="viewlayoutgroup"
                    accesskey="&messagePaneClassic.accesskey;" oncommand="ChangeMailLayout(kClassicMailLayout);"/>
          <menuitem id="messagePaneWide" type="radio" label="&messagePaneWide.label;" name="viewlayoutgroup"
                    accesskey="&messagePaneWide.accesskey;" oncommand="ChangeMailLayout(kWideMailLayout);"/>
          <menuitem id="messagePaneVertical" type="radio" label="&messagePaneVertical.label;" name="viewlayoutgroup"
                    accesskey="&messagePaneVertical.accesskey;" oncommand="ChangeMailLayout(kVerticalMailLayout);"/>
          <menuseparator id="viewMenuAfterPaneVerticalSeparator"/>
          <menuitem id="menu_showMessagePane"
                    type="checkbox"
                    label="&showMessagePaneCmd.label;"
                    accesskey="&showMessagePaneCmd.accesskey;"
                    key="key_toggleMessagePane"
                    oncommand="MsgToggleMessagePane(true);"
                    observes="mailHideMenus"/>
          <menuitem id="menu_showThreadPane"
                    type="checkbox"
                    label="&showThreadPaneCmd.label;"
                    accesskey="&showThreadPaneCmd.accesskey;"
                    key="key_toggleThreadPane"
                    oncommand="MsgToggleThreadPane();"
                    observes="mailHideMenus"/>
          <menuitem id="menu_showFolderPane"
                    type="checkbox"
                    label="&showFolderPaneCmd.label;"
                    accesskey="&showFolderPaneCmd.accesskey;"
                    key="key_toggleFolderPane"
                    oncommand="MsgToggleFolderPane(true);"
                    observes="mailHideMenus"/>
        </menupopup>
      </menu>
      <menuseparator id="viewMessagesMenuSeparator" observes="mailHideMenus"/>
      <menu id="viewSortMenu" label="&sortMenu.label;"
            accesskey="&sortMenu.accesskey;" observes="mailHideMenus">
        <menupopup id="menu_viewSortPopup" onpopupshowing="InitViewSortByMenu()">
          <menuitem id="sortByDateMenuitem" type="radio" name="sortby" label="&sortByDateCmd.label;" accesskey="&sortByDateCmd.accesskey;" oncommand="MsgSortThreadPane('byDate')"/>
          <menuitem id="sortByReceivedMenuitem" type="radio" name="sortby" label="&sortByReceivedCmd.label;" accesskey="&sortByReceivedCmd.accesskey;" oncommand="MsgSortThreadPane('byReceived')"/>
          <menuitem id="sortByFlagMenuitem" type="radio" name="sortby" label="&sortByFlagCmd.label;" accesskey="&sortByFlagCmd.accesskey;" oncommand="MsgSortThreadPane('byFlagged')"/>
          <menuitem id="sortByOrderReceivedMenuitem" type="radio" name="sortby" label="&sortByOrderReceivedCmd.label;"  accesskey="&sortByOrderReceivedCmd.accesskey;" oncommand="MsgSortThreadPane('byId')"/>
          <menuitem id="sortByPriorityMenuitem" type="radio" name="sortby" label="&sortByPriorityCmd.label;" accesskey="&sortByPriorityCmd.accesskey;" oncommand="MsgSortThreadPane('byPriority')"/>
          <menuitem id="sortByFromMenuitem" type="radio" name="sortby" label="&sortByFromCmd.label;" accesskey="&sortByFromCmd.accesskey;" oncommand="MsgSortThreadPane('byAuthor')"/>
          <menuitem id="sortByRecipientMenuitem" type="radio" name="sortby" label="&sortByRecipientCmd.label;" accesskey="&sortByRecipientCmd.accesskey;" oncommand="MsgSortThreadPane('byRecipient')"/>
          <menuitem id="sortBySizeMenuitem" type="radio" name="sortby" label="&sortBySizeCmd.label;" accesskey="&sortBySizeCmd.accesskey;" oncommand="MsgSortThreadPane('bySize')"/>
          <menuitem id="sortByStatusMenuitem" type="radio" name="sortby" label="&sortByStatusCmd.label;" accesskey="&sortByStatusCmd.accesskey;" oncommand="MsgSortThreadPane('byStatus')"/>
          <menuitem id="sortBySubjectMenuitem" type="radio" name="sortby" label="&sortBySubjectCmd.label;" accesskey="&sortBySubjectCmd.accesskey;" oncommand="MsgSortThreadPane('bySubject')"/>
          <menuitem id="sortByUnreadMenuitem" type="radio" name="sortby" label="&sortByUnreadCmd.label;"  accesskey="&sortByUnreadCmd.accesskey;" oncommand="MsgSortThreadPane('byUnread')"/>
          <menuitem id="sortByTagsMenuitem" type="radio" name="sortby" label="&sortByTagsCmd.label;" accesskey="&sortByTagsCmd.accesskey;" oncommand="MsgSortThreadPane('byTags')"/>
          <menuitem id="sortByJunkStatusMenuitem" type="radio" name="sortby" label="&sortByJunkStatusCmd.label;" accesskey="&sortByJunkStatusCmd.accesskey;" oncommand="MsgSortThreadPane('byJunkStatus')"/>
          <menuitem id="sortByAttachmentsMenuitem" type="radio" name="sortby" label="&sortByAttachmentsCmd.label;" accesskey="&sortByAttachmentsCmd.accesskey;" oncommand="MsgSortThreadPane('byAttachments')"/>
          <menuseparator id="sortAfterAttachmentSeparator"/>
          <menuitem id="sortAscending" type="radio" name="sortdirection" label="&sortAscending.label;" accesskey="&sortAscending.accesskey;" oncommand="MsgSortAscending()"/>
          <menuitem id="sortDescending" type="radio" name="sortdirection" label="&sortDescending.label;" accesskey="&sortDescending.accesskey;" oncommand="MsgSortDescending()"/>
          <menuseparator id="sortAfterDescendingSeparator"/>
          <menuitem id="sortThreaded" type="radio" name="threaded" label="&sortThreaded.label;" accesskey="&sortThreaded.accesskey;" oncommand="MsgSortThreaded();"/>
          <menuitem id="sortUnthreaded" type="radio" name="threaded" label="&sortUnthreaded.label;" accesskey="&sortUnthreaded.accesskey;" oncommand="MsgSortUnthreaded();"/>
          <menuitem id="groupBySort" type="radio" name="group" label="&groupBySort.label;" accesskey="&groupBySort.accesskey;" oncommand="MsgGroupBySort();"/>
        </menupopup>
      </menu>
      <menu id="viewMessageViewMenu" label="&msgsMenu.label;" accesskey="&msgsMenu.accesskey;"
            observes="mailHideMenus" oncommand="ViewChangeByMenuitem(event.target);">
        <menupopup id="viewMessagePopup"
                   onpopupshowing="RefreshViewPopup(this);">
          <menuitem id="viewMessageAll"
                    label="&viewAll.label;"
                    accesskey="&viewAll.accesskey;"
                    type="radio"
                    name="viewmessages"
                    value="0"/>
          <menuitem id="viewMessageUnread"
                    label="&viewUnread.label;"
                    accesskey="&viewUnread.accesskey;"
                    type="radio"
                    name="viewmessages"
                    value="1"/>
          <menuitem id="viewMessageNotDeleted"
                    label="&viewNotDeleted.label;"
                    accesskey="&viewNotDeleted.accesskey;"
                    type="radio"
                    name="viewmessages"
                    value="3"/>
          <menuseparator id="messageViewAfterUnreadSeparator"/>
          <menu id="viewMessageTags" label="&viewTags.label;" accesskey="&viewTags.accesskey;">
            <menupopup id="viewMessageTagsPopup"
                       onpopupshowing="RefreshTagsPopup(this);"/>
          </menu>
          <menu id="viewMessageCustomViews" label="&viewCustomViews.label;" accesskey="&viewCustomViews.accesskey;">
            <menupopup id="viewMessageCustomViewsPopup"
                       onpopupshowing="RefreshCustomViewsPopup(this);"/>
          </menu>
          <menuseparator id="messageViewAfterCustomSeparator"/>
          <menuitem id="viewMessageVirtualFolder" value="7" label="&viewVirtualFolder.label;" accesskey="&viewVirtualFolder.accesskey;"/>
          <menuitem id="viewMessageCustomize"     value="8" label="&viewCustomizeView.label;" accesskey="&viewCustomizeView.accesskey;"/>
        </menupopup>
      </menu>
      <menu id="viewMessagesMenu" label="&threads.label;"
            accesskey="&threads.accesskey;" observes="mailHideMenus">
        <menupopup id="menu_ThreadsPopup" onpopupshowing="InitViewMessagesMenu()">
          <menuitem id="viewAllMessagesMenuItem" type="radio" name="viewmessages" label="&allMsgsCmd.label;" accesskey="&allMsgsCmd.accesskey;" disabled="true" command="cmd_viewAllMsgs"/>
          <menuitem id="viewUnreadMessagesMenuItem" type="radio" name="viewmessages" label="&unreadMsgsCmd.label;" accesskey="&unreadMsgsCmd.accesskey;" disabled="true" command="cmd_viewUnreadMsgs"/>
          <menuitem id="viewThreadsWithUnreadMenuItem" type="radio" name="viewmessages" label="&threadsWithUnreadCmd.label;" accesskey="&threadsWithUnreadCmd.accesskey;" disabled="true" command="cmd_viewThreadsWithUnread"/>
          <menuitem id="viewWatchedThreadsWithUnreadMenuItem" type="radio" name="viewmessages" label="&watchedThreadsWithUnreadCmd.label;" accesskey="&watchedThreadsWithUnreadCmd.accesskey;" disabled="true" command="cmd_viewWatchedThreadsWithUnread"/>
          <menuseparator id="threadsAfterWatchedSeparator"/>
          <menuitem id="viewIgnoredThreadsMenuItem" type="checkbox" label="&ignoredThreadsCmd.label;" disabled="true" command="cmd_viewIgnoredThreads" accesskey="&ignoredThreadsCmd.accesskey;"/>
          <menuseparator id="threadsAfterIgnoredSeparator"/>
          <menuitem label="&expandAllThreadsCmd.label;" accesskey="&expandAllThreadsCmd.accesskey;" key="key_expandAllThreads" disabled="true" command="cmd_expandAllThreads"/>
          <menuitem label="&collapseAllThreadsCmd.label;" accesskey="&collapseAllThreadsCmd.accesskey;" key="key_collapseAllThreads" disabled="true" command="cmd_collapseAllThreads"/>
        </menupopup>
      </menu>
      <menuseparator id="viewAfterThreadsSeparator"/>
      <menu id="viewheadersmenu" label="&headersMenu.label;" accesskey="&headersMenu.accesskey;">
        <menupopup id="menu_HeadersPopup" onpopupshowing="InitViewHeadersMenu();">
          <menuitem id="viewallheaders"
                    type="radio"
                    name="viewheadergroup"
                    label="&headersAllCmd.label;"
                    accesskey="&headersAllCmd.accesskey;"
                    oncommand="MsgViewAllHeaders();"/>
          <menuitem id="viewnormalheaders"
                    type="radio"
                    name="viewheadergroup"
                    label="&headersNormalCmd.label;"
                    accesskey="&headersNormalCmd.accesskey;"
                    oncommand="MsgViewNormalHeaders();"/>
        </menupopup>
      </menu>
      <menu id="viewBodyMenu" accesskey="&bodyMenu.accesskey;" label="&bodyMenu.label;">
        <menupopup id="viewBodyPopMenu" onpopupshowing="InitViewBodyMenu()">
          <menuitem id="bodyAllowHTML"
                    type="radio"
                    name="bodyPlaintextVsHTMLPref"
                    label="&bodyAllowHTML.label;"
                    accesskey="&bodyAllowHTML.accesskey;"
                    oncommand="MsgBodyAllowHTML()"/>
          <menuitem id="bodySanitized"
                    type="radio"
                    name="bodyPlaintextVsHTMLPref"
                    label="&bodySanitized.label;"
                    accesskey="&bodySanitized.accesskey;"
                    oncommand="MsgBodySanitized()"/>
          <menuitem id="bodyAsPlaintext"
                    type="radio"
                    name="bodyPlaintextVsHTMLPref"
                    label="&bodyAsPlaintext.label;"
                    accesskey="&bodyAsPlaintext.accesskey;"
                    oncommand="MsgBodyAsPlaintext()"/>
          <menuitem id="bodyAllParts"
                    type="radio"
                    name="bodyPlaintextVsHTMLPref"
                    label="&bodyAllParts.label;"
                    accesskey="&bodyAllParts.accesskey;"
                    oncommand="MsgBodyAllParts();"/>
        </menupopup>
      </menu>
      <menu id="viewFeedSummary"
            label="&bodyMenuFeed.label;"
            accesskey="&bodyMenuFeed.accesskey;">
        <menupopup id="viewFeedSummaryPopupMenu"
                   onpopupshowing="InitViewBodyMenu()">
          <menuitem id="bodyFeedSummaryAllowHTML"
                    type="radio"
                    name="viewFeedBodyHTMLGroup"
                    label="&bodyAllowHTML.label;"
                    accesskey="&bodyAllowHTML.accesskey;"
                    oncommand="MsgFeedBodyRenderPrefs(false, 0, 0)"/>
          <menuitem id="bodyFeedSummarySanitized"
                    type="radio"
                    name="viewFeedBodyHTMLGroup"
                    label="&bodySanitized.label;"
                    accesskey="&bodySanitized.accesskey;"
                    oncommand="MsgFeedBodyRenderPrefs(false, 3, disallow_classes_no_html)"/>
          <menuitem id="bodyFeedSummaryAsPlaintext"
                    type="radio"
                    name="viewFeedBodyHTMLGroup"
                    label="&bodyAsPlaintext.label;"
                    accesskey="&bodyAsPlaintext.accesskey;"
                    oncommand="MsgFeedBodyRenderPrefs(true, 1, disallow_classes_no_html)"/>
          <menuseparator id="viewFeedSummarySeparator"/>
          <menuitem id="bodyFeedGlobalWebPage"
                    type="radio"
                    name="viewFeedSummaryGroup"
                    label="&viewFeedWebPage.label;"
                    accesskey="&viewFeedWebPage.accesskey;"
                    oncommand="ChangeFeedShowSummaryPref(0)"/>
          <menuitem id="bodyFeedGlobalSummary"
                    type="radio"
                    name="viewFeedSummaryGroup"
                    label="&viewFeedSummary.label;"
                    accesskey="&viewFeedSummary.accesskey;"
                    oncommand="ChangeFeedShowSummaryPref(1)"/>
          <menuitem id="bodyFeedPerFolderPref"
                    type="radio"
                    name="viewFeedSummaryGroup"
                    label="&viewFeedSummaryFeedPropsPref.label;"
                    accesskey="&viewFeedSummaryFeedPropsPref.accesskey;"
                    oncommand="ChangeFeedShowSummaryPref(2)"/>
        </menupopup>
      </menu>
      <menuitem id="viewAttachmentsInlineMenuitem"
                type="checkbox"
                checked="true"
                label="&viewAttachmentsInlineCmd.label;"
                accesskey="&viewAttachmentsInlineCmd.accesskey;"
                oncommand="ToggleInlineAttachment(event.target)"/>
      <menuseparator id="viewAfterAttachmentsSeparator"/>
      <menuitem id="stopMenuitem"
                label="&stopCmd.label;"
                accesskey="&stopCmd.accesskey;"
                key="key_stop"
                disabled="true"
                command="cmd_stop"/>
      <menuitem id="menu_Stop"
                label="&reloadCmd.label;"
                key="key_reload"
                accesskey="&reloadCmd.accesskey;"
                command="cmd_reload"/>
      <menuseparator id="viewAfterStopSeparator"/>
      <!-- overlayed from viewZoomOverlay.xul -->
      <menu id="menu_zoom"/>
      <menu id="charsetMenu"
            onpopupshowing="UpdateCharsetMenu(msgWindow.mailCharacterSet, this);"
            oncommand="MailSetCharacterSet(event);"/>
      <menuseparator id="viewAfterCharsetSeparator"/>
      <menuitem id="pageSourceMenuItem" label="&pageSourceCmd.label;" key="key_viewPageSource" accesskey="&pageSourceCmd.accesskey;" command="cmd_viewPageSource"/>
      <menuseparator observes="mailHideMenus"/>
      <!-- overlayed from viewApplyThemeOverlay.xul -->
      <menu id="menu_viewApplyTheme" observes="mailHideMenus"/>
    </menupopup>
  </menu>

  <menu id="goMenu" label="&goMenu.label;" accesskey="&goMenu.accesskey;" datasources="rdf:null"
        oncommand="SelectFolder(event.target.getAttribute('value'));"
        sortResource="http://home.netscape.com/NC-rdf#FolderTreeName" sortDirection="ascending">
    <menupopup id="menu_GoPopup" onpopupshowing="InitGoMessagesMenu();">
      <menu id="goNextMenu" label="&nextMenu.label;" accesskey="&nextMenu.accesskey;">
        <menupopup id="menu_GoNextPopup">
          <menuitem id="nextMsgMenuItem"
                    label="&nextMsgCmd.label;"
                    accesskey="&nextMsgCmd.accesskey;"
                    key="key_nextMsg"
                    command="cmd_nextMsg"/>
          <menuitem id="nextUnreadMsgMenuItem"
                    label="&nextUnreadMsgCmd.label;"
                    accesskey="&nextUnreadMsgCmd.accesskey;"
                    key="key_nextUnreadMsg"
                    command="cmd_nextUnreadMsg"/>
          <menuitem id="nextFlaggedMenuItem"
                    label="&nextFlaggedMsgCmd.label;"
                    accesskey="&nextFlaggedMsgCmd.accesskey;"
                    command="cmd_nextFlaggedMsg"/>
          <menuseparator id="goNextAfterFlaggedSeparator"/>
          <menuitem id="nextUnreadThreadMenuItem"
                    label="&nextUnreadThread.label;"
                    accesskey="&nextUnreadThread.accesskey;"
                    key="key_nextUnreadThread"
                    command="cmd_nextUnreadThread"/>
        </menupopup>
      </menu>
      <menu id="goPreviousMenu" label="&prevMenu.label;" accesskey="&prevMenu.accesskey;">
        <menupopup id="menu_GoPreviousPopup">
          <menuitem id="prevMsgMenuItem"
                    label="&prevMsgCmd.label;"
                    accesskey="&prevMsgCmd.accesskey;"
                    key="key_previousMsg"
                    command="cmd_previousMsg"/>
          <menuitem id="prevUnreadMsgMenuItem"
                    label="&prevUnreadMsgCmd.label;"
                    accesskey="&prevUnreadMsgCmd.accesskey;"
                    key="key_previousUnreadMsg"
                    command="cmd_previousUnreadMsg"/>
          <menuitem id="prevFlaggedMenuItem"
                    label="&prevFlaggedMsgCmd.label;"
                    accesskey="&prevFlaggedMsgCmd.accesskey;"
                    command="cmd_previousFlaggedMsg"/>
        </menupopup>
      </menu>
      <menuitem id="menu_goBack"
                label="&goBackCmd.label;"
                accesskey="&goBackCmd.accesskey;"
                key="key_goBack"
                command="cmd_goBack"/>
      <menuitem id="menu_goForward"
                label="&goForwardCmd.label;"
                accesskey="&goForwardCmd.accesskey;"
                key="key_goForward"
                command="cmd_goForward"/>
      <menuseparator id="goNextAfterForwardSeparator" observes="mailHideMenus"/>
      <menuitem id="goStartPage" label="&startPageCmd.label;"
                accesskey="&startPageCmd.accesskey;" command="cmd_goStartPage"
                observes="mailHideMenus"/>
      <menuseparator id="goNextAfterStartPageSeparator" observes="mailHideMenus"/>
    </menupopup>
    <template>
      <rule iscontainer="true" isempty="false">
        <menupopup>
          <menu uri="rdf:*" class="folderMenuItem menu-iconic"
                observes="mailFolderPane"
              SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
              BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
              IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
              IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
              ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType"
              HasUnreadMessages="rdf:http://home.netscape.com/NC-rdf#HasUnreadMessages"
              NewMessages="rdf:http://home.netscape.com/NC-rdf#NewMessages"
              SubfoldersHaveUnreadMessages="rdf:http://home.netscape.com/NC-rdf#SubfoldersHaveUnreadMessages"
              label="rdf:http://home.netscape.com/NC-rdf#Name">
            <menupopup>
              <menuitem value="rdf:*"
                  class="folderMenuItem menuitem-iconic"
                  SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
                  BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
                  IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
                  IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
                  ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType"
                  HasUnreadMessages="rdf:http://home.netscape.com/NC-rdf#HasUnreadMessages"
                  NewMessages="rdf:http://home.netscape.com/NC-rdf#NewMessages"
                  SubfoldersHaveUnreadMessages="rdf:http://home.netscape.com/NC-rdf#SubfoldersHaveUnreadMessages"
                  label="rdf:http://home.netscape.com/NC-rdf#Name"/>
              <menuseparator/>
            </menupopup>
          </menu>
        </menupopup>
      </rule>
      <rule>
        <menupopup>
          <menuitem uri="rdf:*" value="rdf:*" class="folderMenuItem menuitem-iconic"
                    observes="mailFolderPane"
              SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
              BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
              IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
              IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
              ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType"
              HasUnreadMessages="rdf:http://home.netscape.com/NC-rdf#HasUnreadMessages"
              NewMessages="rdf:http://home.netscape.com/NC-rdf#NewMessages"
              SubfoldersHaveUnreadMessages="rdf:http://home.netscape.com/NC-rdf#SubfoldersHaveUnreadMessages"
              label="rdf:http://home.netscape.com/NC-rdf#Name"/>
        </menupopup>
      </rule>
    </template>
  </menu>

  <menu id="messageMenu" label="&msgMenu.label;" accesskey="&msgMenu.accesskey;">
    <menupopup id="messageMenuPopup" onpopupshowing="InitMessageMenu();">
      <menuitem id="newMsgCmd"
                label="&newMsgCmd.label;"
                accesskey="&newMsgCmd.accesskey;"
                key="key_newMessage"
                oncommand="MsgNewMessage(null);"/>
      <menuitem id="replyMainMenu"
                label="&replyMsgCmd.label;"
                accesskey="&replyMsgCmd.accesskey;"
                key="key_reply"
                command="cmd_reply"/>
      <menuitem id="replyListMainMenu"
                label="&replyListCmd.label;"
                accesskey="&replyListCmd.accesskey;"
                command="cmd_replyList"/>
      <menuitem id="replyNewsgroupMainMenu"
                label="&replyNewsgroupCmd.label;"
                accesskey="&replyNewsgroupCmd.accesskey;"
                key="key_reply"
                command="cmd_replyGroup"/>
      <menuitem id="replySenderMainMenu"
                label="&replySenderCmd.label;"
                accesskey="&replySenderCmd.accesskey;"
                command="cmd_replySender"/>
      <menuitem id="replyallMainMenu"
                label="&replyToAllMsgCmd.label;"
                accesskey="&replyToAllMsgCmd.accesskey;"
                key="key_replyall"
                command="cmd_replyall"/>
      <menuitem id="replySenderAndNewsgroupMainMenu"
                label="&replyToSenderAndNewsgroupCmd.label;"
                accesskey="&replyToSenderAndNewsgroupCmd.accesskey;"
                key="key_replyall" command="cmd_replySenderAndGroup"/>
      <menuitem id="replyAllRecipientsMainMenu"
                label="&replyToAllRecipientsCmd.label;"
                accesskey="&replyToAllRecipientsCmd.accesskey;"
                command="cmd_replyAllRecipients"/>
      <menuitem id="menu_forwardMsg"
                label="&forwardMsgCmd.label;"
                accesskey="&forwardMsgCmd.accesskey;"
                key="key_forward"
                command="cmd_forward"/>
      <menu id="forwardAsMenu" label="&forwardAsMenu.label;" accesskey="&forwardAsMenu.accesskey;">
        <menupopup id="menu_forwardAsPopup">
          <menuitem id="menu_forwardAsInline"
                    label="&forwardAsInline.label;"
                    accesskey="&forwardAsInline.accesskey;"
                    command="cmd_forwardInline"/>
          <menuitem id="menu_forwardAsAttachment"
                    label="&forwardAsAttachmentCmd.label;"
                    accesskey="&forwardAsAttachmentCmd.accesskey;"
                    command="cmd_forwardAttachment"/>
        </menupopup>
      </menu>
      <menuitem id="menu_editMsgAsNew"
                label="&editMsgAsNewCmd.label;"
                accesskey="&editMsgAsNewCmd.accesskey;"
                key="key_editAsNew"
                command="cmd_editAsNew"/>
      <menuitem id="openMessageWindowMenuitem"
                label="&openMessageWindowCmd.label;"
                command="cmd_openMessage"
                accesskey="&openMessageWindowCmd.accesskey;"
                key="key_openMessage" observes="mailHideMenus"/>
      <menu id="openFeedMessage"
            label="&openFeedMessage.label;"
            accesskey="&openFeedMessage.accesskey;">
        <menupopup id="menu_openFeedMessage">
          <menuitem id="menu_openFeedWebPageInWindow"
                    type="radio"
                    name="openFeedGroup"
                    label="&openFeedWebPageInWindow.label;"
                    accesskey="&openFeedWebPageInWindow.accesskey;"
                    oncommand="ChangeFeedOpenHandler(0);"/>
          <menuitem id="menu_openFeedSummaryInWindow"
                    type="radio"
                    name="openFeedGroup"
                    label="&openFeedSummaryInWindow.label;"
                    accesskey="&openFeedSummaryInWindow.accesskey;"
                    oncommand="ChangeFeedOpenHandler(1);"/>
          <menuitem id="menu_openFeedWebPageInMessagePane"
                    type="radio"
                    name="openFeedGroup"
                    label="&openFeedWebPageInMP.label;"
                    accesskey="&openFeedWebPageInMP.accesskey;"
                    oncommand="ChangeFeedOpenHandler(2);"/>
        </menupopup>
      </menu>
     <menuseparator id="messageAfterOpenMsgSeparator"/>
     <menu id="msgAttachmentMenu" label="&openAttachmentCmd.label;"
           accesskey="&openAttachmentCmd.accesskey;" disabled="true">
       <menupopup id="attachmentMenuList" onpopupshowing="FillAttachmentListPopup(this);"/>
     </menu>
     <menuseparator id="messageAfterAttachmentMenuSeparator"/>
     <menuitem id="archiveMainMenu"
               label="&archiveMsgCmd.label;"
               accesskey="&archiveMsgCmd.accesskey;"
               key="key_archive"
               command="cmd_archive"/>
     <menu id="moveMenu"
           label="&moveMsgToMenu.label;"
           accesskey="&moveMsgToMenu.accesskey;"
           datasources="rdf:null"
           sortResource="http://home.netscape.com/NC-rdf#FolderTreeName"
           sortDirection="ascending">
        <menupopup id="menu_MovePopup">
          <menu label="&moveCopyMsgRecentMenu.label;"
                accesskey="&moveCopyMsgRecentMenu.accesskey;"
                sortResource="http://home.netscape.com/NC-rdf#FolderTreeName"
                sortDirection="ascending"
                datasources="rdf:mailnewsrecentfolders"
                ref="mailnewsrecentfolders:/">
            <menupopup/>
            <template>
              <rule nc:CanFileMessages="true">
                <menupopup id="menu_MoveRecentPopup">
                  <menuitem uri="..." class="folderMenuItem menuitem-iconic"
                            label="rdf:http://home.netscape.com/NC-rdf#FolderTreeSimpleName"
                            oncommand="MsgMoveMessage(event.target);"
                            SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
                            BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
                            IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
                            IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
                            ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType"/>
                </menupopup>
              </rule>
            </template>
          </menu>
          <menuseparator id="moveMsgRecentSeparator"/>
        </menupopup>
        <template>
        <rule nc:NoSelect="true" iscontainer="true" isempty="false">
          <menupopup>
            <menu uri="..."  class="folderMenuItem menu-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name">
              <menupopup>
                <menuitem label="&fileHereMenu.label;"
                          accesskey="&fileHereMenu.accesskey;"
                          disabled="true"/>
                <menuseparator/>
              </menupopup>
            </menu>
          </menupopup>
        </rule>
        <rule nc:NoSelect="true">
          <menupopup>
            <menuitem uri="..."  class="folderMenuItem menu-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name" disabled="true"/>
          </menupopup>
        </rule>
        <rule nc:CanFileMessages="true" iscontainer="true" isempty="false">
          <menupopup>
            <menu uri="..."  class="folderMenuItem menu-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name"
             SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
             BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
             IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
             IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
             ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType">
              <menupopup>
                <menuitem label="&fileHereMenu.label;"
                          accesskey="&fileHereMenu.accesskey;"
                          oncommand="MsgMoveMessage(event.target.parentNode.parentNode)"/>
                <menuseparator/>
              </menupopup>
            </menu>
          </menupopup>
        </rule>
        <rule nc:CanFileMessagesOnServer="false">
          <!-- don't show servers (nntp & any others) which does not allow message filing -->
          <!-- File, Move & Copy menus -->
        </rule>
        <rule nc:CanFileMessages="false" iscontainer="true" isempty="false">
          <!-- note, there is no "file here" -->
          <menupopup>
            <menu uri="..."  class="folderMenuItem menu-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name"
             SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
             BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
             IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
             IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
             ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType">
              <menupopup/>
            </menu>
          </menupopup>
        </rule>
        <rule nc:CanFileMessages="true">
          <menupopup>
            <menuitem uri="..." class="folderMenuItem menuitem-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name" oncommand="MsgMoveMessage(event.target)"
             SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
             BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
             IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
             IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
             ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType"/>
          </menupopup>
        </rule>
      </template>
    </menu>
    <menu id="copyMenu"
          label="&copyMsgToMenu.label;"
          accesskey="&copyMsgToMenu.accesskey;"
          datasources="rdf:null"
          sortResource="http://home.netscape.com/NC-rdf#FolderTreeName"
          sortDirection="ascending">
        <menupopup id="menu_copyPopup">
          <menu label="&moveCopyMsgRecentMenu.label;"
                accesskey="&moveCopyMsgRecentMenu.accesskey;"
                sortResource="http://home.netscape.com/NC-rdf#FolderTreeName"
                sortDirection="ascending"
                datasources="rdf:mailnewsrecentfolders"
                ref="mailnewsrecentfolders:/">
            <menupopup/>
            <template>
              <rule nc:CanFileMessages="true">
                <menupopup id="menu_copyRecentPopup">
                  <menuitem uri="..." class="folderMenuItem menuitem-iconic"
                            label="rdf:http://home.netscape.com/NC-rdf#FolderTreeSimpleName"
                            oncommand="MsgCopyMessage(event.target);"
                            SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
                            BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
                            IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
                            IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
                            ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType"/>
                </menupopup>
              </rule>
            </template>
          </menu>
          <menuseparator id="copyMsgRecentSeparator"/>
        </menupopup>
      <template>
        <rule nc:NoSelect="true" iscontainer="true" isempty="false">
          <menupopup>
            <menu uri="..."  class="folderMenuItem menu-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name">
              <menupopup>
                <menuitem label="&copyHereMenu.label;"
                          accesskey="&copyHereMenu.accesskey;"
                          disabled="true"/>
                <menuseparator/>
              </menupopup>
            </menu>
          </menupopup>
        </rule>
        <rule nc:NoSelect="true">
          <menupopup>
            <menuitem uri="..."  class="folderMenuItem menu-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name" disabled="true"/>
          </menupopup>
        </rule>
        <rule nc:CanFileMessages="true" iscontainer="true" isempty="false">
          <menupopup id="menu_copyFolderMenuPopup3">
            <menu uri="..."  class="folderMenuItem menu-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name"
             SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
             BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
             IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
             IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
             ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType">
              <menupopup>
                <menuitem label="&copyHereMenu.label;"
                          accesskey="&copyHereMenu.accesskey;"
                          oncommand="MsgCopyMessage(event.target.parentNode.parentNode)"/>
                <menuseparator/>
              </menupopup>
            </menu>
          </menupopup>
        </rule>
        <rule nc:CanFileMessagesOnServer="false">
          <!-- don't show servers (nntp & any others) which does not allow message filing -->
          <!-- File, Move & Copy menus -->
        </rule>
        <rule nc:CanFileMessages="false" iscontainer="true" isempty="false">
          <!-- note, there is no "file here" -->
          <menupopup>
            <menu uri="..."  class="folderMenuItem menu-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name"
             SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
             BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
             IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
             IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
             ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType">
              <menupopup/>
            </menu>
          </menupopup>
        </rule>
        <rule nc:CanFileMessages="true">
          <menupopup>
            <menuitem uri="..." class="folderMenuItem menuitem-iconic" label="rdf:http://home.netscape.com/NC-rdf#Name"
             oncommand="MsgCopyMessage(event.target)"
             SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
             BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
             IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
             IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
             ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType"/>
          </menupopup>
        </rule>
      </template>
    </menu>
    <menu id="tagMenu" label="&tagMenu.label;" accesskey="&tagMenu.accesskey;">
      <menupopup id="tagMenu-tagpopup" onpopupshowing="InitMessageTags(this)">
        <menuitem id="tagMenu-tagRemoveAll" oncommand="RemoveAllMessageTags();"/>
        <menuseparator id="tagMenuAfterRemoveSeparator"/>
        <menuseparator id="tagMenuBeforeCustomizeSeparator"/>
        <menuitem id="tagMenu-tagCustomize"
                  label="&tagCustomize.label;"
                  accesskey="&tagCustomize.accesskey;"
                  oncommand="goPreferences('tags_pane');"/>
      </menupopup>
    </menu>
    <menu id="markMenu" label="&markMenu.label;" accesskey="&markMenu.accesskey;">
      <menupopup id="menu_MarkPopup" onpopupshowing="InitMessageMark()">
        <menuitem id="markReadMenuItem"
                  type="checkbox"
                  label="&markAsReadCmd.label;"
                  accesskey="&markAsReadCmd.accesskey;"
                  key="key_toggleRead"
                  command="cmd_markAsRead"/>
        <menuitem id="markThreadReadMenuItem"
                  label="&markThreadAsReadCmd.label;"
                  accesskey="&markThreadAsReadCmd.accesskey;"
                  key="key_markThreadAsRead"
                  command="cmd_markThreadAsRead"/>
        <menuitem id="markReadByDateMenuItem"
                  label="&markReadByDateCmd.label;"
                  accesskey="&markReadByDateCmd.accesskey;"
                  key="key_markReadByDate"
                  command="cmd_markReadByDate"/>
        <menuitem id="markAllReadMenuItem"
                  label="&markAllReadCmd.label;"
                  accesskey="&markAllReadCmd.accesskey;"
                  key="key_markAllRead"
                  command="cmd_markAllRead"/>
        <menuseparator id="markMenuAfterAllReadSeparator"/>
        <menuitem id="markFlaggedMenuItem"
                  type="checkbox"
                  label="&markFlaggedCmd.label;"
                  accesskey="&markFlaggedCmd.accesskey;"
                  key="key_toggleFlagged"
                  command="cmd_markAsFlagged"/>
        <menuseparator id="markMenuAfterFlaggedSeparator"/>
        <menuitem id="markAsJunkMenuItem"
                  label="&markAsJunkCmd.label;"
                  accesskey="&markAsJunkCmd.accesskey;"
                  key="key_markJunk"
                  command="cmd_markAsJunk"/>
        <menuitem id="markAsNotJunkMenuItem"
                  label="&markAsNotJunkCmd.label;"
                  accesskey="&markAsNotJunkCmd.accesskey;"
                  key="key_markNotJunk"
                  command="cmd_markAsNotJunk"/>
        <menuitem id="recalculateJunkScoreMenuItem"
                  label="&recalculateJunkScoreCmd.label;"
                  accesskey="&recalculateJunkScoreCmd.accesskey;"
                  command="cmd_recalculateJunkScore"/>
        <menuitem id="markAsShowRemoteMenuitem"
                  label="&markAsShowRemoteCmd.label;"
                  accesskey="&markAsShowRemoteCmd.accesskey;"
                  key="key_markShowRemote"
                  command="cmd_markAsShowRemote"/>
        <menuitem id="markAsNotPhishMenuItem"
                  label="&markAsNotPhishCmd.label;"
                  accesskey="&markAsNotPhishCmd.accesskey;"
                  key="key_markNotPhish"
                  command="cmd_markAsNotPhish"/>
      </menupopup>
    </menu>
    <menuseparator id="messageMenuAfterMarkSeparator"/>
    <menuitem id="createFilter"
              label="&createFilter.label;"
              accesskey="&createFilter.accesskey;"
              command="cmd_createFilterFromMenu"/>
    <menuseparator id="threadItemsSeparator"/>
    <menuitem id="menu_cancel"
              label="&cancelNewsMsgCmd.label;"
              accesskey="&cancelNewsMsgCmd.accesskey;"
              command="cmd_cancel"/>
    <menuitem id="killThread"
              label="&killThreadMenu.label;"
              accesskey="&killThreadMenu.accesskey;"
              key="key_killThread" command="cmd_killThread"/>
    <menuitem id="killSubthread"
              label="&killSubthreadMenu.label;"
              accesskey="&killSubthreadMenu.accesskey;"
              key="key_killSubthread" command="cmd_killSubthread"/>
    <menuitem id="watchThread"
              label="&watchThreadMenu.label;"
              accesskey="&watchThreadMenu.accesskey;"
              key="key_watchThread" command="cmd_watchThread"/>
  </menupopup>
</menu>

<menu id="tasksMenu">
  <menupopup id="taskPopup" onpopupshowing="document.commandDispatcher.updateCommands('create-menu-tasks')">
    <menuitem id="menu_SearchMail"
              label="&searchMailCmd.label;"
              key="key_searchMail"
              accesskey="&searchMailCmd.accesskey;"
              command="cmd_search"/>
    <menuitem id="menu_SearchAddresses"
              label="&searchAddressesCmd.label;"
              accesskey="&searchAddressesCmd.accesskey;"
              oncommand="MsgSearchAddresses()"/>
    <menuseparator id="tasksMenuAfterAddressesSeparator"/>
    <menuitem id="menu_Filters"
              label="&filtersCmd.label;"
              accesskey="&filtersCmd.accesskey;"
              command="cmd_displayMsgFilters"/>
    <menuitem id="applyFilters"
              label="&filtersApply.label;"
              accesskey="&filtersApply.accesskey;"
              command="cmd_applyFilters"/>
    <menuitem id="applyFiltersToSelection"
              label="&filtersApplyToMessage.label;"
              accesskey="&filtersApplyToMessage.accesskey;"
              command="cmd_applyFiltersToSelection"/>
    <menuseparator id="tasksMenuAfterApplySeparator"/>
    <menuitem id="runJunkControls"
              label="&runJunkControls.label;"
              accesskey="&runJunkControls.accesskey;"
              command="cmd_runJunkControls"/>
    <menuitem id="deleteJunk"
              label="&deleteJunk.label;"
              accesskey="&deleteJunk.accesskey;"
              command="cmd_deleteJunk"/>
    <menuseparator id="tasksMenuAfterDeleteSeparator"/>
    <menuitem id="menu_import"
              label="&importCmd.label;"
              accesskey="&importCmd.accesskey;"
              oncommand="toImport();"/>
    <menuseparator/>
  </menupopup>
</menu>
<menu id="windowMenu"/>
<menu id="menu_Help"/>
<spacer flex="100%"/>
</menubar>

<toolbox id="mail-toolbox"
         mode="full"
         defaultmode="full">
  <toolbar class="toolbar-primary chromeclass-toolbar"
           id="msgToolbar"
           persist="collapsed"
           grippytooltiptext="&mailToolbar.tooltip;"
           toolbarname="&showMessengerToolbarCmd.label;"
           accesskey="&showMessengerToolbarCmd.accesskey;"
           customizable="true"
           defaultset="button-getmsg,button-newmsg,separator,button-reply,button-replyall,button-forward,separator,button-goback,button-goforward,button-next,button-junk,button-delete,button-mark,spring,throbber-box"
           context="toolbar-context-menu">
  </toolbar>
  <toolbarset id="customToolbars" context="toolbar-context-menu"/>

  <toolbarpalette id="MailToolbarPalette">
    <toolbarbutton id="button-getmsg"
                   class="toolbarbutton-1"
                   type="menu-button"
                   label="&getMsgButton.label;"
                   tooltiptext="&getMsgButton.tooltip;"
                   sortResource="http://home.netscape.com/NC-rdf#FolderTreeName"
                   sortDirection="ascending"
                   observes="button_getNewMessages"
                   datasources="rdf:msgaccountmanager rdf:mailnewsfolders"
                   oncommand="goDoCommand('cmd_getNewMessages');"
                   containment="http://home.netscape.com/NC-rdf#child"
                   ref="msgaccounts:/">
      <menupopup  id="button-getMsgPopup"
                  onpopupshowing="getMsgToolbarMenu_init();">
        <menuitem id="button-getAllNewMsg"
                  label="&getAllNewMsgCmd.label;"
                  command="cmd_getMsgsForAuthAccounts"/>
        <menuseparator id="button-getAllNewMsgSeparator"/>
      </menupopup>
      <template>
        <rule nc:IsServer="true" nc:CanGetMessages="true">
          <menupopup>
            <menuitem uri="..."
                      value="..."
                      label="rdf:http://home.netscape.com/NC-rdf#Name"
                      oncommand="MsgGetMessagesForAccount(event);"/>
          </menupopup>
        </rule>
      </template>
    </toolbarbutton>
    <toolbarbutton id="button-newmsg"
                   class="toolbarbutton-1"
                   type="menu-button"
                   label="&newMsgButton.label;"
                   tooltiptext="&newMsgButton.tooltip;"
                   oncommand="MsgNewMessage(event)">
      <menupopup id="button-newMsgPopup"
                 onpopupshowing="InitNewMsgMenu(this);">
        <menuitem id="button-newMsgHTML"
                  label="&newHTMLMessageCmd.label;"
                  accesskey="&newHTMLMessageCmd.accesskey;"
                  mode="HTML"/>
        <menuitem id="button-newMsgPlain"
                  label="&newPlainTextMessageCmd.label;"
                  accesskey="&newPlainTextMessageCmd.accesskey;"
                  mode="PlainText"/>
        <menuitem id="newMsgButton-mail-menuitem" hidden="true"/>
      </menupopup>
    </toolbarbutton>
    <toolbarbutton id="button-reply"
                   class="toolbarbutton-1"
                   type="menu-button"
                   label="&replyButton.label;"
                   tooltiptext="&replyButton.tooltip;"
                   observes="button_reply"
                   oncommand="MsgReplyMessage(event)">
      <menupopup id="button-replyPopup"
                 onpopupshowing="InitMessageReply(this);">
        <menuitem label="&replyMsgCmd.label;"
                  accesskey="&replyMsgCmd.accesskey;"
                  command="cmd_reply"
                  default="true"/>
        <menuitem label="&replyListCmd.label;"
                  accesskey="&replyListCmd.accesskey;"
                  command="cmd_replyList"/>
        <menuitem label="&replyNewsgroupCmd.label;"
                  accesskey="&replyNewsgroupCmd.accesskey;"
                  command="cmd_replyGroup"
                  default="true"/>
        <menuitem label="&replySenderCmd.label;"
                  accesskey="&replySenderCmd.accesskey;"
                  command="cmd_replySender"/>
      </menupopup>
    </toolbarbutton>
    <toolbarbutton id="button-replyall"
                   class="toolbarbutton-1"
                   label="&replyAllButton.label;"
                   tooltiptext="&replyAllButton.tooltip;"
                   tooltiptextmail="&replyAllButton.tooltip;"
                   tooltiptextnews="&replyAllButtonNews.tooltip;"
                   observes="button_replyall"
                   oncommand="MsgReplyToAllMessage(event)">
      <menupopup id="button-replyallPopup">
        <menuitem label="&replyToSenderAndNewsgroupCmd.label;"
                  accesskey="&replyToSenderAndNewsgroupCmd.accesskey;"
                  command="cmd_replySenderAndGroup"
                  default="true"/>
        <menuitem label="&replyToAllRecipientsCmd.label;"
                  accesskey="&replyToAllRecipientsCmd.accesskey;"
                  command="cmd_replyAllRecipients"/>
      </menupopup>
    </toolbarbutton>
    <toolbarbutton id="button-forward"
                   class="toolbarbutton-1"
                   type="menu-button"
                   label="&forwardButton.label;"
                   tooltiptext="&forwardButton.tooltip;"
                   observes="button_forward"
                   oncommand="MsgForwardMessage(event)">
      <menupopup id="button-forwardPopup"
                 onpopupshowing="InitMessageForward(this);">
        <menuitem label="&forwardAsInline.label;"
                  accesskey="&forwardAsInline.accesskey;"
                  command="cmd_forwardInline"/>
        <menuitem label="&forwardAsAttachmentCmd.label;"
                  accesskey="&forwardAsAttachmentCmd.accesskey;"
                  command="cmd_forwardAttachment"/>
      </menupopup>
    </toolbarbutton>
    <toolbarbutton id="button-file"
                   type="menu"
                   class="toolbarbutton-1"
                   label="&fileButton.label;"
                   observes="button_file"
                   datasources="rdf:null"
                   tooltiptext="&fileButton.tooltip;"
                   sortResource="http://home.netscape.com/NC-rdf#FolderTreeName"
                   sortDirection="ascending">
      <menupopup id="button-filePopup">
        <menu label="&moveCopyMsgRecentMenu.label;"
              accesskey="&moveCopyMsgRecentMenu.accesskey;"
              sortResource="http://home.netscape.com/NC-rdf#FolderTreeName"
              sortDirection="ascending"
              datasources="rdf:mailnewsrecentfolders"
              ref="mailnewsrecentfolders:/">
          <menupopup/>
          <template>
            <rule nc:CanFileMessages="true">
              <menupopup>
                <menuitem uri="..."
                          class="folderMenuItem menuitem-iconic"
                          label="rdf:http://home.netscape.com/NC-rdf#FolderTreeSimpleName"
                          oncommand="MsgMoveMessage(event.target);"
                          SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
                          BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
                          IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
                          IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
                          ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType"/>
              </menupopup>
            </rule>
          </template>
        </menu>
        <menuseparator/>
      </menupopup>
      <template>
      <rule nc:NoSelect="true" iscontainer="true" isempty="false">
        <menupopup>
          <menu uri="..."
                class="folderMenuItem menu-iconic"
                label="rdf:http://home.netscape.com/NC-rdf#Name">
            <menupopup>
              <menuitem label="&fileHereMenu.label;"
                        accesskey="&fileHereMenu.accesskey;"
                        disabled="true"/>
              <menuseparator/>
            </menupopup>
          </menu>
        </menupopup>
      </rule>
      <rule nc:NoSelect="true">
        <menupopup>
          <menuitem uri="..."
                    class="folderMenuItem menu-iconic"
                    label="rdf:http://home.netscape.com/NC-rdf#Name"
                    disabled="true"/>
        </menupopup>
      </rule>
        <rule nc:CanFileMessages="true" iscontainer="true" isempty="false">
          <menupopup>
            <menu uri="..."
                  class="folderMenuItem menu-iconic"
                  label="rdf:http://home.netscape.com/NC-rdf#Name"
                  SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
                  BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
                  IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
                  IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
                  ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType">
              <menupopup>
                <menuitem label="&fileHereMenu.label;"
                          accesskey="&fileHereMenu.accesskey;"
                          oncommand="MsgMoveMessage(event.target.parentNode.parentNode)"/>
                <menuseparator/>
              </menupopup>
            </menu>
          </menupopup>
        </rule>
        <rule nc:CanFileMessagesOnServer="false">
          <!-- don't show servers (nntp & any others) which does not allow message filing -->
          <!-- File, Move & Copy menus -->
        </rule>
        <rule nc:CanFileMessages="false" iscontainer="true" isempty="false">
        <!-- note, there is no "file here" -->
          <menupopup>
            <menu uri="..."
                  class="folderMenuItem menu-iconic"
                  label="rdf:http://home.netscape.com/NC-rdf#Name"
                  SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
                  BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
                  IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
                  IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
                  ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType">
              <menupopup/>
            </menu>
          </menupopup>
        </rule>
        <rule nc:CanFileMessages="true">
          <menupopup>
            <menuitem uri="..."
                      class="folderMenuItem menuitem-iconic"
                      label="rdf:http://home.netscape.com/NC-rdf#Name"
                      oncommand="MsgMoveMessage(event.target)"
                      SpecialFolder="rdf:http://home.netscape.com/NC-rdf#SpecialFolder"
                      BiffState="rdf:http://home.netscape.com/NC-rdf#BiffState"
                      IsServer="rdf:http://home.netscape.com/NC-rdf#IsServer"
                      IsSecure="rdf:http://home.netscape.com/NC-rdf#IsSecure"
                      ServerType="rdf:http://home.netscape.com/NC-rdf#ServerType"/>
          </menupopup>
        </rule>
      </template>
    </toolbarbutton>

    <toolbarbutton id="button-goback"
                   class="toolbarbutton-1"
                   type="menu-button"
                   label="&goBackButton.label;"
                   tooltiptext="&goBackButton.tooltip;"
                   observes="button_goBack"
                   oncommand="goDoCommand('cmd_goBack')">
      <menupopup id="button-goBackPopup"
                 onpopupshowing="InitBackToolbarMenu(this)"
                 oncommand="NavigateToUri(event.target);"/>
    </toolbarbutton>

    <toolbarbutton id="button-goforward"
                   class="toolbarbutton-1"
                   type="menu-button"
                   label="&goForwardButton.label;"
                   tooltiptext="&goForwardButton.tooltip;"
                   observes="button_goForward"
                   oncommand="goDoCommand('cmd_goForward')">
      <menupopup id="button-goForwardPopup"
                 onpopupshowing="InitForwardToolbarMenu(this)"
                 oncommand="NavigateToUri(event.target);"/>
    </toolbarbutton>

    <toolbarbutton id="button-next"
                   class="toolbarbutton-1"
                   type="menu-button"
                   label="&nextButton.label;"
                   tooltiptext="&nextButton.tooltip;"
                   observes="button_next"
                   oncommand="goDoCommand('button_next')">
      <menupopup id="button-nextPopup"
                 onpopupshowing="InitGoMessagesMenu();">
        <menuitem label="&nextMsgCmd.label;"
                  accesskey="&nextMsgCmd.accesskey;"
                  command="cmd_nextMsg"/>
        <menuitem label="&nextUnreadMsgCmd.label;"
                  accesskey="&nextUnreadMsgCmd.accesskey;"
                  command="cmd_nextUnreadMsg" default="true"/>
        <menuitem label="&nextFlaggedMsgCmd.label;"
                  accesskey="&nextFlaggedMsgCmd.accesskey;"
                  command="cmd_nextFlaggedMsg"/>
        <menuseparator/>
        <menuitem label="&nextUnreadThread.label;"
                  accesskey="&nextUnreadThread.accesskey;"
                  command="cmd_nextUnreadThread"/>
      </menupopup>
    </toolbarbutton>

    <toolbaritem id="button-junk"
                 title="&junkButton.label;"
                 observes="button_junk">
      <deck id="junk-deck"
            oncommand="goDoCommand('button_junk')">
        <toolbarbutton id="button-isJunk"
                       class="toolbarbutton-1"
                       label="&junkButton.label;"
                       tooltiptext="&junkButton.tooltip;"
                       observes="button-junk"/>
        <toolbarbutton id="button-notJunk"
                       class="toolbarbutton-1"
                       label="&notJunkButton.label;"
                       tooltiptext="&notJunkButton.tooltip;"
                       observes="button-junk"/>
      </deck>
    </toolbaritem>

    <toolbaritem id="button-delete"
                 title="&deleteButton.label;"
                 observes="button_delete">
      <deck id="delete-deck">
        <toolbarbutton id="button-mark-deleted"
                       class="toolbarbutton-1"
                       label="&deleteButton.label;"
                       tooltiptext="&deleteButton.tooltip;"
                       observes="button-delete"
                       oncommand="goDoCommand(event.shiftKey ? 'button_shiftDelete' : 'button_delete')"/>
        <toolbarbutton id="button-mark-undelete"
                       class="toolbarbutton-1"
                       label="&undeleteButton.label;"
                       tooltiptext="&undeleteButton.tooltip;"
                       observes="button-delete"
                       oncommand="goDoCommand('button_delete')"/>
      </deck>
    </toolbaritem>

    <toolbarbutton id="button-mark"
                   class="toolbarbutton-1"
                   type="menu-button"
                   label="&markButton.label;"
                   oncommand="goDoCommand('button_mark')"
                   observes="button_mark" tooltiptext="&markButton.tooltip;">
          <menupopup id="button-markPopup"
                     onpopupshowing="InitMessageMark()">
              <menuitem id="markReadToolbarItem"
                        type="checkbox"
                        label="&markAsReadCmd.label;"
                        accesskey="&markAsReadCmd.accesskey;"
                        command="cmd_markAsRead"
                        default="true" />
              <menuitem id="button-markThreadAsRead"
                        label="&markThreadAsReadCmd.label;"
                        accesskey="&markThreadAsReadCmd.accesskey;"
                        command="cmd_markThreadAsRead"/>
              <menuitem id="button-markReadByDate"
                        label="&markReadByDateCmd.label;"
                        accesskey="&markReadByDateCmd.accesskey;"
                        command="cmd_markReadByDate"/>
              <menuitem id="button-markAllRead"
                        label="&markAllReadCmd.label;"
                        accesskey="&markAllReadCmd.accesskey;"
                        command="cmd_markAllRead"/>
              <menuseparator id="button-markAllReadSeparator"/>
              <menuitem id="markFlaggedToolbarItem"
                        type="checkbox"
                        label="&markFlaggedCmd.label;"
                        accesskey="&markFlaggedCmd.accesskey;"
                        command="cmd_markAsFlagged"/>
          </menupopup>
    </toolbarbutton>
    <toolbarbutton id="print-button"
                   observes="button_print"/>
    <toolbarbutton id="button-stop"
                   class="toolbarbutton-1"
                   label="&stopButton.label;"
                   tooltiptext="&stopButton.tooltip;"
                   command="cmd_stop"/>
    <toolbaritem id="button-search-container"
                 title="&searchButton.title;"
                 align="center"
                 class="toolbaritem-noline chromeclass-toolbar-additional">
      <button id="button-search"
              label="&searchButton.label;"
              accesskey="&searchButton.accesskey;"
              tooltiptext="&advancedButton.tooltip;"
              observes="button_search"
              oncommand="goDoCommand('button_search')"/>
      <button id="button-advanced"
              label="&advancedButton.label;"
              accesskey="&advancedButton.accesskey;"
              tooltiptext="&advancedButton.tooltip;"
              observes="button_search"
              oncommand="goDoCommand('button_search')"/>
    </toolbaritem>
    <toolbaritem id="throbber-box"
                 class="toolbaritem-noline"
                 align="center">
        <button id="navigator-throbber"
                oncommand="goClickThrobber('messenger.throbber.url', event)"
                onclick="checkForMiddleClick(this, event);"
                tooltiptext="&throbber.tooltip;"/>
    </toolbaritem>
    <!-- see utilityOverlay.xul -->
    <toolbarbutton id="sync-button"/>
  </toolbarpalette>

</toolbox>

<statusbar class="chromeclass-status" id="status-bar">
  <statusbarpanel id="component-bar"/>
  <statusbarpanel id="statusText" label="&statusText.label;" crop="right" flex="1"/>
  <statusbarpanel class="statusbarpanel-progress" id="statusbar-progresspanel" collapsed="true">
    <progressmeter class="progressmeter-statusbar" id="statusbar-icon" mode="normal" value="0"/>
  </statusbarpanel>
  <statusbarpanel id="unreadMessageCount" hidden="true"/>
  <statusbarpanel id="totalMessageCount" hidden="true"/>
  <statusbarpanel checkfunc="MailCheckBeforeOfflineChange()" id="offline-status" class="statusbarpanel-iconic"/>
</statusbar>

</overlay>
